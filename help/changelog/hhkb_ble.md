## HHKB BLE 固件更新记录
[+]新增 [-]删除 [^]升级 [#]修复 {}重要

<html><div class="attention">
<subtitle>注意</subtitle>

  - 除了可使用列表里 HHKB BLE 的固件外，还可以选择使用 HHKB BLE S。它们的区别在2021年后的固件里，仅为按键扫描方式不同。
  - 选择 <ru>HHKB BLE</ru>，这个固件使用的是 HHKB 原始的扫描方式，速度大概是60Hz。这个经过两年来多个键盘的调度，各批次兼容很好。
  - 选择 <ru>HHKB BLE S</ru>，这个是我修改后的扫描，速度能达到接近1000Hz。但是目前可能部分批次的 HHKB 有兼容问题，比如无法从Lock Mode唤醒。
  - S的固件能直观感受到按键响应速度快一点点，如果 HHKB BLE S 的固件使用无问题，建议就用它。
</div></html>

##### 2021-09-22 (DL9M)
  - [^] 设置为 Tap二合一按键，如果其中是CapsLock，增加一个100ms的延时，让它在MacOS下可以正常切换大小写。
  - [^] 提高 [Esc 与 \`\~](/features/tricky-esc) 功能在单独按触发 Esc 时的响应速度。

##### 2021-04-25 (DL4P)
  - {^} 改进带S的固件兼容性，之前遇到此固件无法从Lock Mode唤醒的，现在应该有所改善。
  - [+] <key>LShift+RShift+V</key>这个快捷键，如果同时还按了<key>LCtrl</key>，增加输出电池电压值。

##### 2021-01-20 (DL1K)
  - {^} 适配v2.5版主控，主要在v2.5上，软件重置蓝牙实际是执行硬件重置。
  - {^} 非S的固件，从DK5O开始的更新，除了按键扫描的部分，也已经包含。

<col_h5>2020-11-28 (DKBS)</col_h5>
  - {#} 修复问题：上一版HHKB BLE S的固件，USB与蓝牙之间切换不可用。
  - {#} 修复问题：上一版HHKB BLE S的固件，插上USB然后再拔下，键盘无法进入节能模式。

<col_h5>2020-11-14 (DKBE)</col_h5>
  - {^} 清除键盘端的蓝牙配对，由 <kbd>LShift+RShift+R</kbd> 改为 <kbd>LShift+RShift+LCtrl+R</kbd>，需要多按一个 <kbd>LCtrl</kbd>，防止误操作。
  - [+] Shift+Esc输出\~的功能，更加的完善，具体看 [Esc 与 \`\~](/features/tricky-esc)
  - [^] 拔掉USB线时，不再重启键盘。

<col_h5>2020-08-15 (DK8F)</col_h5>
  - [#] 修复：HHKB Pro JP版无法从Lock Mode唤醒的问题。
  - { } 提醒：如果还有从Lock Mode唤醒有问题，可能部分批次兼容的原因，请先恢复使用DK5O的固件（键盘选择HHKB BLE，而不是HHKB BLE S）。

<col_h5>2020-08-11 (DK8B)</col_h5> 
  - [^] 按键扫描的部分继续优化，提高了部分的效率，来提高速度。在HHKB Pro2上能达到接近1000Hz。
  - [#] 修复：修饰键 & 瞬时切换层 没有在按下时立即触发的问题。

<col_h5>2020-07-27 (DK7R)</col_h5>
  - {^} 对按键扫描的部分进行了重写，不再采用遵从HHKB原主控的方式。将按键的扫描速度提升了10倍以上，按键的响应速度大大提升，真的用来玩游戏都不是短板了。
  - {^} 降低了一点一级节能时的耗电，这也是大部分时候键盘处于的节能状态。根据使用情况，综合续航会有所提升。
  - [+] 新增：当一个按键设置为**Shift+KEY**时，如果再和**Shift**用，就直接输出**KEY**。举例来说就是一个按键被设置成了直接输出 **{**， 那么 **Shift+{** 就会输出 **[**。
  - [+] 左右Shift+N切换全键无冲时（仅有线下支持全键无冲），在可打字的地方会输出0或6，0代表全键无冲，6代表6键无冲。
  - [+] 左右Shift+P切换节能时，在可打字的地方会输出1或0，1代表节能开启，0代表节能关闭。
  - [-] 取消默认命令按键里的 <kbd>LShift+RShift+数字</kbd> 切换默认层，这个引起误操作时更多。一般默认层切换请自己设置按键。

<col_h5>2020-05-24 (DK5O)</col_h5>
  - [+] <kbd>LShift+RShift+V</kbd> 这组命令键，在按的时候，后面会多输出一个-0或-1，代表键盘蓝牙连接状态。

<col_h5>2020-04-18 (DK4I)</col_h5>
  - {#} 因为有部分人误关掉蓝牙功能，本次更新调整开关蓝牙功能的切换方式，具体见 [蓝牙开关和连接状态](/ble-series/connection-status)

<col_h5>2020-03-16 (DK3G)</col_h5>
  - [#] 修复：Mac下要使用键盘的有线模式，按键无法进入恢复模式等。具体进入方法见 [HHKB BLE Mod](/kb-mods/hhkb-ble) 的补充说明。

<col_h5>2020-03-09 (DK39)</col_h5>
  - {^} 再优化键盘模拟鼠标功能的滚轮部分，之前滚轮速度起飞了。同时USB下移动流畅度再提升一点，速度减一点。
  - [#] 修复一个之前一个小问题：低电量指示会在键盘进入一级节能时，也低亮度闪。正常应该只在使用时闪。

<col_h5>2020-03-07 (DK37)</col_h5>
  - {^} 大幅度提升键盘模拟鼠标功能的流畅和精准性。
  - [+] 宏功能的代码部分重写完成，不过正式推出待配置界面做好。

<col_h5>2020-02-21 (DK2L)</col_h5>
  - [#] 修复：上一个固件 LEDMAP 的“工作模式”指示未正常工作。

<col_h5>2020-02-14 (DK2E)</col_h5>
  - [^] 改进Win_Lock功能。之前只是禁用单独的设置的win键（即LWin或RWin），现在可以让所有与win相关的（包括组合键，二合一键等），都不触发win键本身。这样防止误按的效果更佳。

<col_h5>2020-01-28 (DK1S)</col_h5>
  - [^] 上一个固件第2条会增加一点一级节能时的耗电(0.x ma)，优化一下其他的部分，把这点耗电再抢回来。

<col_h5>2020-01-23 (DK1N)</col_h5>
  - [#] 修复：在使用软件重置或者清除修饰时，最新版win10里会触发启动商店版Office(它的默认快捷键是LCtrl+LShift+LAlt+LWin)问题。
  - [^] 改进对一些PCB有老化的HHKB的兼容
  - [^] 略微减少了扫描一次矩阵按键所用时间
  - [+] 增加一个极低电量提示，固件读取到电压低于3.42v时激活。此模式下低电量提醒灯快闪，一秒3下。建议这个模式提醒时就尽快充电了， 此时键盘用到完全没电大约1天多一点。

<col_h5>2019-10-03 (DJA3)</col_h5>
  - [+] 增加蓝牙多设备切换。具体见  [多设备切换](/ble-series/device-switching)

<col_h5>2019-09-17 (DJ9H)</col_h5>
  - [#] 修复问题：重置蓝牙后初始化时，偶尔重命名未成功。
  - [^] 一处节能优化，续航提升。
  - [^] 蓝牙连接指示灯：未连接时led3闪烁加快一点；已连接时led2和led3一起较慢闪，如果有led2的会显示更直观了。
  - [+] 电池服务如果不正常时，电量指示输出44或45。这个是用来辅助判断问题的。

<col_h5>2019-09-12 (DJ9C)</col_h5>
  - [#] 修复问题：使用完全关闭蓝牙功能后，Mac下插USB无法使用（Win下正常）。

<col_h5>2019-09-09 (DJ99)</col_h5>
  - {#} 修复问题： 左右Shift+R/I/O这三个功能，使用时可能导致蓝牙重新配置或出错。
  - [+] 插USB线识别的设备名，后面增加固件日期。比如今天的固件更新后，USB下识别的设备名就为 HHKB BLE (USB_DJ99),J99分别代表年月日。

<col_h5>2019-08-25</col_h5>
  - [^] 使用 [蓝牙开关和连接状态](/ble-series/connection-status) 完全关闭蓝牙后，键盘的USB可以唤醒电脑了。
  - [^] 有线模式下，默认由NKRO改为6KRO。默认6KRO对各种系统和硬件的兼容更好一些。

<col_h5>2019-08-24</col_h5>
  - [^] 取消启动的延时，然后把那个延时放在了重启键盘前。

<col_h5>2019-08-19</col_h5>
  - {#} 修复问题：部分HHKB在节能状态时，不识别矩阵0行的按键(如JP的Ese Tab Ctrl，US的2 Q W)

<col_h5>2019-08-17</col_h5>
  - {^} 之前版本的固件直接读取KEYMAP后，蓝牙功能相关的增强按键需要重新选择设置
  - [+] 增加蓝牙开关功能，可以完全关闭蓝牙。具体参看： [蓝牙开关和连接状态](/ble-series/connection-status)
  - [#] 修复问题：使用额外充电器(5V)充电时，这时蓝牙会重复的进入一级节能
  - [^] 蓝牙初始化时，HHKB US和JP使用不同的名称，前者HHKB BLE，后者HHKB JP BLE
  - [^] Win10下插着线重启键盘，设置设备里可能没有刷新及时导致显示为“驱动程序错误”，但其实键盘使用正常。有部分用户误解为这是键盘问题，所以本次键盘启动时增加了一个1200ms的启动延迟。
  - [^] 这条不怎么重要，记录一下方便回查。减少了mouse, mouse debug, bootloader_jump的代码空间占用。

<col_h5>2019-07-29</col_h5>
  - {#} 修复插着USB充电时，无线模式下会漏键的问题
  - [^] 提高US版的按键扫描速度
  - [^] 从二级节能(需长按唤醒)唤醒时也提示蓝牙连接状态。并且，减少每次提示的闪烁时间
  - [^] Lock Mode因为仅在无线工作时生效，所以去除插线时按到Lock Mode键时的LED灯提醒


<col_h5>2019-07-16</col_h5>
  - 从这一版之后开始做更新记录