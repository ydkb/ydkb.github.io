function lang_pre_action(){if(jslang=new Lang,Lang.prototype.attrList.push("data-tooltip","data-dropkind"),jslang.dynamic("en","lang/en.json"),jslang.dynamic("zh_cn","lang/zh_cn.json"),NOW_LANG=navigator.userLanguage||navigator.language||navigator.bowserLanguage,"zh-cn"===NOW_LANG.toLowerCase())NOW_LANG="zh_cn";else NOW_LANG="en";console4jslang=!0,null==window.location.href.match(/my.|ava.|18:2|0:8|8080|console/g)&&(console.log=()=>{},console4jslang=!1)}function lang_init(){(new Lang).init({defaultLang:"zh_sc"})}function onLangChange(e){NOW_LANG=e,window.jslang.change(e);var a=".lang-en",s=".lang-zh_sc";"zh_cn"==e&&([a,s]=[s,a]),$(a).show(),$(s).hide(),"zh_cn"!=e&&"en"!=e||(LANG_JSON_CONTENT.token&&LANG_JSON_CONTENT.token["lang-name"]==e?manual_update_lang():fetch(`lang/${e}.json`).then((function(e){if(e.ok)return e.json()})).then((function(e){LANG_JSON_CONTENT=e,manual_update_lang()}))),setTimeout((function(){tooltip_init(),$("#setting-tabs .indicator").html($("#setting-tabs").find(".active")[0].innerHTML),$("#setting-tabs").tabs("updateTabIndicator")}),500)}function manual_update_lang(){$("#user-keyboard").find(".kbd-led").each((function(){var e=$(this).attr("class").match(/.*led(\d)/);if(e&&e[1]>7){var a=LANG_JSON_CONTENT.token[$(this).attr("data-tooltip")];a&&$(this).attr("data-tooltip",a)}})),$("body").find("[lang-id]").each((function(){var e=$(this).attr("lang-id");if(e){var a=LANG_JSON_CONTENT.token[e+" #html"];a&&$(this).html(a);var s=LANG_JSON_CONTENT.token[e+" #title"];s&&$(this).attr("title",s);var t=LANG_JSON_CONTENT.token[e+" #tooltip"];t&&$(this).attr("data-tooltip",t)}}))}function LangChange(e){NOW_LANG!=e&&($("#user-layer-tabs").tabs("select","layer_0"),onLangChange(e))}function lang_from_json(e){let a=LANG_JSON_CONTENT.token[e];return a||(console.log(`${e} not found in json`),e)}LANG_JSON_CONTENT={},NOW_LANG="",nowKBD={pid:0,vid:0,sid:0,viaVersion:0,vialVersion:0,avaVersion:0,deviceName:0,matrix:0,adcValue:0,keymapRows:0,keymapCols:0,keymapLayers:0,keymapSize:0,keymaps:0},nowKBDE={layout:0};const btnSend=document.querySelector("#btnSend"),btnClear=document.querySelector("#btnClear");async function webhid_set_single_key(e,a,s,t){await device_send_data([5,e,a,s,t>>8,255&t])}async function device_open_action(e){isDeviceConnected=1,clearValue(nowKBD),clearValue(nowKBDE),nowKBD.vid=e.vendorId,nowKBD.pid=e.productId,nowKBD.sid=hex16(nowKBD.vid,"V")+hex16(nowKBD.pid,"_P"),console.log(nowKBD.sid),nowKBD.deviceName=e.productName;let a=CONFIG.kbd[nowKBD.sid];if(a){{nowKBD.keymapRows=a.rows,nowKBD.keymapCols=a.cols,nowKBD.deviceName=a.name;let e=CONFIG.kbd[nowKBD.sid].layout;e&&(nowKBDE.layout=`keyboards/${nowKBD.sid}/${e}`,console.log(nowKBDE.layout),layout_load(nowKBDE.layout))}btnDevice.textContent=nowKBD.deviceName,await device_send_data([1]),await device_send_data([254,0]),await device_send_data([17]),console.log(nowKBD.keymapSize);for(let e=0;e<nowKBD.keymapSize;e+=28)await device_send_data([18,e>>8&255,255&e,28]);load_keymap_on_keyboard(nowKBD.keymaps[0]),$("#user-layer-tabs").find("li a").each((function(){$(this).attr("id").match(/layer-(\d)/i)[1]<nowKBD.keymapLayers?$(this).show():$(this).hide()})),$("#user-layer-tabs, #user-keyboard, #setting-panel").show(),setTimeout((function(){tabs_init()}),100)}}function data_vial_process(e,a){if(console.log("vial data input: "+a),0==e[1]){for(let e=0;e<4;e++)nowKBD.vialVersion|=a[e]<<8*e;console.log("Vial Protocol Version: "+nowKBD.vialVersion)}}function device_got_data(e,a){if(254!=e[0])if(253==a[0]&&163==a[1]){let e=a[2]>>4;for(let s=0;s<nowKBD.keymapCols;s++)nowKBD.adcValue[e][s]=a[s+3];nowKBD.matrix[e]=a[31]|a[30]<<8;let s=e;for(let e=0;e<nowKBD.keymapCols;e++){let a="k"+s.toString(32)+e.toString(32),t=$("#user-keyboard").find(`.key.${a}`);if(t.length>0){t[0].textContent=nowKBD.adcValue[s][e];let a=nowKBD.matrix[s]&1<<e,n=t.closest('[class^="mykeycap"]');a?(n.addClass("valid"),n.addClass("active")):n.removeClass("active")}}}else if(1==a[0])nowKBD.viaVersion=a[1]<<8|a[2],console.log("VIA Protocol Version: "+nowKBD.viaVersion);else if(17==a[0])nowKBD.keymapLayers=a[1],console.log("Layers: "+nowKBD.keymapLayers),nowKBD.keymaps=new Array(nowKBD.keymapLayers).fill(0).map((()=>new Array(nowKBD.keymapRows).fill(1).map((()=>new Array(nowKBD.keymapCols).fill(1))))),nowKBD.keymapSize=nowKBD.keymapLayers*nowKBD.keymapRows*nowKBD.keymapCols*2,console.log("keymapSize: "+nowKBD.keymapSize),nowKBD.matrix=new Array(nowKBD.keymapRows),nowKBD.adcValue=new Array(nowKBD.keymapRows).fill(1).map((()=>new Array(nowKBD.keymapCols).fill(1)));else if(254==a[0]);else if(18==a[0]){let e=(a[1]<<8|a[2])/2,s=a[3];for(let t=0;t<s;t+=2){let s=parseInt(e/(nowKBD.keymapRows*nowKBD.keymapCols)),n=parseInt(e/nowKBD.keymapCols)%nowKBD.keymapRows,o=e%nowKBD.keymapCols;if(nowKBD.keymaps[s][n][o]=a[t+4]<<8|a[t+5],e+=1,e>=nowKBD.keymapSize/2)break}}else console.log(a);else data_vial_process(e,a)}function clearValue(e){Object.keys(e).forEach((a=>{"object"==typeof e[a]&&null!==e[a]?clearValue(e[a]):e[a]=""}))}var updateMatrixTimer;function matrix_test_on(e,a=0){isDeviceConnected&&!updateMatrixTimer&&1==e?updateMatrixTimer=setInterval((()=>{device.opened?device_send_data([253,a?163:3]):clearInterval(updateMatrixTimer)}),25):(clearInterval(updateMatrixTimer),updateMatrixTimer=null)}function device_close_action(e){btnDevice.textContent="连接键盘";let a=document.querySelectorAll(".valid");for(let e=0;e<a.length;e++)a[e].classList.remove("valid");isDeviceConnected=0,$("#user-tabs").find("ul").hide(),$("#user-keyboard, #vial-config, #editor-settings").hide(),$("#setting-panel").hide()}function wait_ms(e){return new Promise(((a,s)=>{setTimeout((()=>{console.log(`wait ${e}ms`),a(e)}),e)}))}document.addEventListener("keydown",(function(e){e.returnValue=!1})),$("#layers").click((function(){let e=$(this).val();load_keymap(e)})),$(document).ready((function(){device_close_action(),keycode_init()}));const btnDevice=document.querySelector("#btnDevice");let device,isDeviceConnected=0;async function device_send_data(e=[0]){if(device.opened){let a=new Uint8Array(32);for(let s=0;s<e.length;s++)a[s]=e[s];const s=new Promise((e=>{device.addEventListener("inputreport",e,{once:!0})}));await device.sendReport(0,a);const{data:t,reportId:n}=await s;device_got_data(a,new Uint8Array(t.buffer))}}function keycode_init(){for(let e in keyToCodeDefault)keyToCode[e]=keyToCodeDefault[e];for(let e in keyInfoDefault)keyInfo[e]=keyInfoDefault[e],keyInfo[e].desc||(keyInfo[e].desc=keyInfo[e].name)}function code_to_key(e){for(let a in keyToCode)if("_"!==a[0]&&keyToCode[a]==e)return{action:a,num:"",mod:"",key:""};let a;for(let s in keyToCode)if("_"===s[0])if(s.match("_MAX")){if(e>=keyToCode[a]&&e<=keyToCode[s]){let s=e-keyToCode[a],t="",n="";switch(a){case"_QK_MODS":case"_QK_MOD_TAP":t=e>>8&31,n=255&e;break;case"_QK_LAYER_TAP":case"_QK_LAYER_TAP_INT":s>>=8,n=255&e;break;case"_QK_LAYER_MOD":s=(240&e)>>4,t=15&e;break;case"_QK_TO":case"_QK_MOMENTAR":case"_QK_DEF_LAYER":case"_QK_TOGGLE_LAYER":case"_QK_ONE_SHOT_LAYER":case"_QK_LAYER_TAP_TOGGLE":break;case"_QK_ONE_SHOT_MOD":t=31&e}return{action:a,num:s,mod:t,key:n}}}else a=s;return null}function get_keyinfo(e){let a={action:e,num:"",mod:"",key:""};if(isNumber(e)&&(a=code_to_key(e)),!a)return{name:hex16(e),desc:hex16(e)};let s=keyInfo[a.action];if(s){let e,t;if("_QK_MODS"==a.action){let n=" + <kt>"+get_keyinfo(a.key).desc+"</kt>";a.key<4&&(n=""),e=s.name.format(a.num,mods_codes(a.mod).name,halfkey(get_keyinfo(a.key).name,2)),t=s.desc.format(a.num,mods_codes(a.mod).desc,n)}else e=s.name.format(a.num,mods_codes(a.mod).name,halfkey(get_keyinfo(a.key).name)),t=s.desc.format(a.num,mods_codes(a.mod).desc,get_keyinfo(a.key).desc);return t||(t=e),{name:e,desc:t}}return isNumber(e)&&console.log(e,a.action),{name:a.action,desc:a.action}}function name_to_code(e){if(parseNumber(e))return parseNumber(e);if(null!=keyToCode[e])return keyToCode[e];let a,s=e.match(/([a-zA-Z]+(->)?)\d+.*?/i);for(let e in keyToCode){if("_"!==e[0]||e.match("_MAX"))continue;let t=removeHTMLTags(keyInfo[e].name).match(/([a-zA-Z]+(->)?){.*?/i);if(t&&t[1]===s[1]){a=e;break}}if(a)for(let s=keyToCode[a];s<keyToCode[a+"_MAX"];s++){if(removeHTMLTags(get_keyinfo(s).name)==e)return s}}function halfkey(e,a=1){return e&&e.length>0?`<div class="halfkey key mykeycap${a}">${e=e.replace("<br>"," ")}</div>`:e}function short_keycap_name(e,a,s,t,n){return e.match(new RegExp(s,"i"))&&$(`.key.${a}:visible`).each((function(){$(this).parents(".border")[0].offsetWidth<=54*t&&(e=e.replace(new RegExp(s,"i"),n))})),e}function display_label(e,a){var s=new get_keyinfo(e),t=new get_keyinfo(255&e),n={name:s.name,desc:s.desc};return n.name=short_keycap_name(n.name,a,"backspace",1.6,"BS"),$("#keycap_style_gmk.nowdsa")[0]&&(t.name_dsa?n.name=" "+s.name_dsa:(n.name=n.name.slice(0,3).match(/<i/g)?n.name:n.name.toUpperCase(),n.name=n.name.replace("MYKEYCAP1","mykeycap1").replace("MYKEYCAP2","mykeycap2").replace("HALFKEY","halfkey"))),kc_alpha(e)||kc_numpad(e)?n.name=` <span class="bigfont">${n.name}</span>`:(kc_symbol(e)||kc_function(e))&&(n.name=` <span class="midfont">${n.name}</span>`),is_mac&&(n.name=keylabel_mac(n.name),n.desc=keylabel_mac(n.desc),n.name=short_keycap_name(n.name,a,"option",1,"opt"),n.name=short_keycap_name(n.name,a,"control",1,"ctrl"),kc_numpad(e)&&(n.name=` <i class="bigfont">${n.name.replace(/<br>.*/g,"")}</i>`)),$(`.key.${a}:visible`).each((function(){$(this).closest(".encoder").length>0&&(n.name=n.name.replaceAll("<br>",""))})),"en"==NOW_LANG&&(n.desc=window.jslang.translate(n.desc,"en")),n}function user_keyboard_auto_height_width(){$("#user-keyboard")[0];const e=$("#user-keyboard").find(".plate");let a=1/0,s=1/0,t=0,n=0;e.each((function(){const e=$(this)[0].getBoundingClientRect();console.log(e);const o=e.top,i=e.left,d=e.right,c=e.bottom;a=Math.min(a,o>0?o:a),s=Math.min(s,i>0?i:s),t=Math.max(t,d),n=Math.max(n,c)}));const o=t-s,i=n-a;console.log(`总宽度: ${o}px, 总高度: ${i}px`)}btnDevice.onclick=async()=>{if(device&&device.opened)await device.close(),device_close_action(device);else try{const e=await navigator.hid.requestDevice(deviceFilters);if(0==e.length)return void console.log("devices.length = 0; return;");device=e[0],device.opened||(await device.open(),device_open_action(device)),device.oninputreport=e=>{const{data:a,device:s,reportId:t}=e;let n=new Uint8Array(a.buffer);if(253==n[0]&&238==n[1]){const e=new TextDecoder("utf-8").decode(n).slice(2);console.log("MSG: "+e)}}}catch(e){console.log(e)}},navigator.hid.onconnect=e=>{},navigator.hid.ondisconnect=e=>{device=null,device_close_action()};var keyToCode=new Object,qkActionToCode=new Object,keyInfo=new Object,qkActionInfo=new Object;function kc_alpha(e){return e>3&&e<30}function kc_symbol(e){return e>29&&e<40||e>44&&e<57||100==e}function kc_function(e){return e>57&&e<70||e>103&&e<116}function kc_numpad(e){return e>83&&e<100&&88!=e||176==e}var keyToCodeDefault={_QK_MODS:256,_QK_MODS_MAX:8191,_QK_MOD_TAP:24576,_QK_MOD_TAP_MAX:32767,_QK_LAYER_TAP:16384,_QK_LAYER_TAP_MAX:18431,_QK_LAYER_TAP_INT:18432,_QK_LAYER_TAP_INT_MAX:20479,_QK_LAYER_MOD:22784,_QK_LAYER_MOD_MAX:23039,_QK_TO:20496,_QK_TO_MAX:20511,_QK_MOMENTARY:20736,_QK_MOMENTARY_MAX:20767,_QK_DEF_LAYER:20992,_QK_DEF_LAYER_MAX:21023,_QK_TOGGLE_LAYER:21248,_QK_TOGGLE_LAYER_MAX:21279,_QK_ONE_SHOT_LAYER:21504,_QK_ONE_SHOT_LAYER_MAX:21535,_QK_ONE_SHOT_MOD:21760,_QK_ONE_SHOT_MOD_MAX:22015,_QK_LAYER_TAP_TOGGLE:22528,_QK_LAYER_TAP_TOGGLE_MAX:22559,_QK_LAYER_MOD_MASK:15,_QK_MACRO:24338,_QK_MACRO_MAX:24353,_QK_KB:24448,_QK_KB_MAX:24463,KC_NO:0,KC_TRNS:1,KC_KC:2,KC_UNDF:3,KC_A:4,KC_B:5,KC_C:6,KC_D:7,KC_E:8,KC_F:9,KC_G:10,KC_H:11,KC_I:12,KC_J:13,KC_K:14,KC_L:15,KC_M:16,KC_N:17,KC_O:18,KC_P:19,KC_Q:20,KC_R:21,KC_S:22,KC_T:23,KC_U:24,KC_V:25,KC_W:26,KC_X:27,KC_Y:28,KC_Z:29,KC_1:30,KC_2:31,KC_3:32,KC_4:33,KC_5:34,KC_6:35,KC_7:36,KC_8:37,KC_9:38,KC_0:39,KC_ENT:40,KC_ESC:41,KC_BSPC:42,KC_TAB:43,KC_SPC:44,KC_MINS:45,KC_EQL:46,KC_LBRC:47,KC_RBRC:48,KC_BSLS:49,KC_NUHS:50,KC_SCLN:51,KC_QUOT:52,KC_GRV:53,KC_COMM:54,KC_DOT:55,KC_SLSH:56,KC_CAPS:57,KC_F1:58,KC_F2:59,KC_F3:60,KC_F4:61,KC_F5:62,KC_F6:63,KC_F7:64,KC_F8:65,KC_F9:66,KC_F10:67,KC_F11:68,KC_F12:69,KC_PSCR:70,KC_SLCK:71,KC_PAUS:72,KC_INS:73,KC_HOME:74,KC_PGUP:75,KC_DEL:76,KC_END:77,KC_PGDN:78,KC_RGHT:79,KC_LEFT:80,KC_DOWN:81,KC_UP:82,KC_NLCK:83,KC_PSLS:84,KC_PAST:85,KC_PMNS:86,KC_PPLS:87,KC_PENT:88,KC_P1:89,KC_P2:90,KC_P3:91,KC_P4:92,KC_P5:93,KC_P6:94,KC_P7:95,KC_P8:96,KC_P9:97,KC_P0:98,KC_PDOT:99,KC_NUBS:100,KC_APP:101,KC_POWER:102,KC_PEQL:103,KC_F13:104,KC_F14:105,KC_F15:106,KC_F16:107,KC_F17:108,KC_F18:109,KC_F19:110,KC_F20:111,KC_F21:112,KC_F22:113,KC_F23:114,KC_F24:115,KC_EXECUTE:116,KC_HELP:117,KC_MENU:118,KC_SELECT:119,KC_STOP:120,KC_AGAIN:121,KC_UNDO:122,KC_CUT:123,KC_COPY:124,KC_PASTE:125,KC_FIND:126,KC_LCAP:130,KC_LNUM:131,KC_LSCR:132,KC_PCMM:133,KC_KP_EQUAL_AS400:134,KC_RO:135,KC_KANA:136,KC_JYEN:137,KC_HENK:138,KC_MHEN:139,KC_INT6:140,KC_INT7:141,KC_INT8:142,KC_INT9:143,KC_HAEN:144,KC_HANJ:145,KC_LANG3:146,KC_LANG4:147,KC_LANG5:148,KC_LANG6:149,KC_LANG7:150,KC_LANG8:151,KC_LANG9:152,KC_ERAS:153,KC_SYSREQ:154,KC_CANCEL:155,KC_CLR:156,KC_CLEAR:156,KC_PRIOR:157,KC_OUT:160,KC_OPER:161,KC_CLEAR_AGAIN:162,KC_CRSEL:163,KC_EXSEL:164,KC_PWR:165,KC_SLEP:166,KC_WAKE:167,KC_MUTE:168,KC_VOLU:169,KC_VOLD:170,KC_MNXT:171,KC_MPRV:172,KC_MSTP:173,KC_MPLY:174,KC_MSEL:175,KC_EJCT:176,KC_MAIL:177,KC_CALC:178,KC_MYCM:179,KC_WWW_SEARCH:180,KC_WWW_HOME:181,KC_WWW_BACK:182,KC_WWW_FORWARD:183,KC_WWW_STOP:184,KC_WWW_REFRESH:185,KC_WWW_FAVORITES:186,KC_MFFD:187,KC_MRWD:188,KC_BRIU:189,KC_BRID:190,KC_LCTL:224,KC_LSFT:225,KC_LALT:226,KC_LGUI:227,KC_RCTL:228,KC_RSFT:229,KC_RALT:230,KC_RGUI:231,KC_MS_UP:240,KC_MS_DOWN:241,KC_MS_LEFT:242,KC_MS_RIGHT:243,KC_MS_BTN1:244,KC_MS_BTN2:245,KC_MS_BTN3:246,KC_MS_BTN4:247,KC_MS_BTN5:248,KC_MS_WH_UP:249,KC_MS_WH_DOWN:250,KC_MS_WH_LEFT:251,KC_MS_WH_RIGHT:252,KC_MS_ACCEL0:253,KC_MS_ACCEL1:254,KC_MS_ACCEL2:255,RESET:23552,DEBUG:23553,MAGIC_TOGGLE_NKRO:23572,KC_GESC:23574,AU_ON:23581,AU_OFF:23582,AU_TOG:23583,CLICKY_TOGGLE:23584,CLICKY_ENABLE:23585,CLICKY_DISABLE:23586,CLICKY_UP:23587,CLICKY_DOWN:23588,CLICKY_RESET:23589,MU_ON:23590,MU_OFF:23591,MU_TOG:23592,MU_MOD:23593,BL_ON:23739,BL_OFF:23740,BL_DEC:23741,BL_INC:23742,BL_TOGG:23743,BL_STEP:23744,BL_BRTG:23745,RGB_TOG:23746,RGB_MOD:23747,RGB_RMOD:23748,RGB_HUI:23749,RGB_HUD:23750,RGB_SAI:23751,RGB_SAD:23752,RGB_VAI:23753,RGB_VAD:23754,RGB_SPI:23755,RGB_SPD:23756,RGB_M_P:23757,RGB_M_B:23758,RGB_M_R:23759,RGB_M_SW:23760,RGB_M_SN:23761,RGB_M_K:23762,RGB_M_X:23763,RGB_M_G:23764,KC_LSPO:23767,KC_RSPC:23768,KC_SFTENT:23769,KC_LCPO:23795,KC_RCPC:23796,KC_LAPO:23797,KC_RAPC:23798,BR_INC:24320,BR_DEC:24321,EF_INC:24322,EF_DEC:24323,ES_INC:24324,ES_DEC:24325,H1_INC:24326,H1_DEC:24327,S1_INC:24328,S1_DEC:24329,H2_INC:24330,H2_DEC:24331,S2_INC:24332,S2_DEC:24333,FN_MO13:24336,FN_MO23:24337};deepFreeze(keyToCodeDefault);var keyInfoDefault={_QK_MODS:{name:"{1}+<br>{2}",desc:"<kt>{1}</kt>{2}"},_QK_MOD_TAP:{name:"{1}<br>{2}",desc:"Hold = <kt>{1}</kt>, Tap = <kt>{2}</kt>"},_QK_LAYER_TAP:{name:"LT{0}<br>{2}",desc:"Hold = <kt>Layer {0}</kt>, Tap = <kt>{2}</kt>"},_QK_LAYER_TAP_INT:{name:"LT<sub>i</sub>{0}<br>{2}",desc:"Hold = <kt>Layer {0}</kt> with interrupt, Tap = <kt>{2}</kt>"},_QK_LAYER_MOD:{name:"LM{0}<br>{1}",desc:"<kt>Fn{0}</kt> with <kt>{1}</kt>"},_QK_TO:{name:"T->{0}",desc:"<kt>Layer {0} on</kt> and other layers off"},_QK_MOMENTARY:{name:"Fn{0}",desc:"Momentarily activates <kt>Layer {0}</kt>"},_QK_DEF_LAYER:{name:"DF{0}",desc:"Set <kt>Layer {0}</kt> as default layer"},_QK_TOGGLE_LAYER:{name:"T{0}",desc:"Toggle <kt>Layer {0}</kt> ON/OFF"},_QK_ONE_SHOT_LAYER:{name:"OSL<br>{0}",desc:"Momentarily activates <kt>Layer {0}</kt> until a key is pressed."},_QK_ONE_SHOT_MOD:{name:"OSM<br>{1}",desc:"Enable <kt>{1}</kt> for one keypress"},_QK_LAYER_TAP_TOGGLE:{name:"TT{0}",desc:"Hold = <kt>Fn{0}</kt>，Tap = <kt>TG{0}</kt>"},_QK_LAYER_MOD_MASK:{name:"LayerModMask",desc:"LayerModMask"},_QK_MACRO:{name:"Marco{0}",desc:"宏{0}"},_QK_KB:{name:"User{0}",desc:"User{0}"},KC_NO:{name:'<i class="fa fa-ban fs22"></i>',desc:"NO"},KC_TRNS:{name:"▽",desc:"当前层此按键穿透到更低层。可用<kt>鼠标中键</kt>点击按键设置"},KC_KC:{name:"(kc)",desc:"(kc)"},KC_UNDF:{name:"undefined",desc:"未定义功能"},KC_A:{name:"A"},KC_B:{name:"B"},KC_C:{name:"C"},KC_D:{name:"D"},KC_E:{name:"E"},KC_F:{name:"F"},KC_G:{name:"G"},KC_H:{name:"H"},KC_I:{name:"I"},KC_J:{name:"J"},KC_K:{name:"K"},KC_L:{name:"L"},KC_M:{name:"M"},KC_N:{name:"N"},KC_O:{name:"O"},KC_P:{name:"P"},KC_Q:{name:"Q"},KC_R:{name:"R"},KC_S:{name:"S"},KC_T:{name:"T"},KC_U:{name:"U"},KC_V:{name:"V"},KC_W:{name:"W"},KC_X:{name:"X"},KC_Y:{name:"Y"},KC_Z:{name:"Z"},KC_1:{name:"!<br>1",desc:"1 !"},KC_2:{name:"@<br>2",desc:"2 @"},KC_3:{name:"#<br>3",desc:"3 #"},KC_4:{name:"$<br>4",desc:"4 $"},KC_5:{name:"%<br>5",desc:"5 %"},KC_6:{name:"^<br>6",desc:"6 ^"},KC_7:{name:"&<br>7",desc:"7 &"},KC_8:{name:"*<br>8",desc:"8 *"},KC_9:{name:"(<br>9",desc:"9 ("},KC_0:{name:")<br>0",desc:"0 )"},KC_ENT:{name:"Enter"},KC_ESC:{name:"Esc"},KC_BSPC:{name:"Backspace"},KC_TAB:{name:"Tab"},KC_SPC:{name:"Space"},KC_MINS:{name:"_<br>-",desc:"- _"},KC_EQL:{name:"+<br>=",desc:"= +"},KC_LBRC:{name:"{<br>[",desc:"[ {"},KC_RBRC:{name:"}<br>]",desc:"] }"},KC_BSLS:{name:"|<br>\\",desc:"\\ |"},KC_NUHS:{name:"~<br>#",desc:"ISO ~#"},KC_SCLN:{name:":<br>;",desc:"; :"},KC_QUOT:{name:"\"<br>'",desc:"' \""},KC_GRV:{name:"~<br>`",desc:"` ~"},KC_COMM:{name:"<<br>,",desc:", <"},KC_DOT:{name:"><br>.",desc:". >"},KC_SLSH:{name:"?<br>/",desc:"/ ?"},KC_CAPS:{name:"Caps Lock",desc:"CapsLock"},KC_F1:{name:"F1"},KC_F2:{name:"F2"},KC_F3:{name:"F3"},KC_F4:{name:"F4"},KC_F5:{name:"F5"},KC_F6:{name:"F6"},KC_F7:{name:"F7"},KC_F8:{name:"F8"},KC_F9:{name:"F9"},KC_F10:{name:"F10"},KC_F11:{name:"F11"},KC_F12:{name:"F12"},KC_PSCR:{name:"Print<br>Scrn",desc:"Print Screen"},KC_SLCK:{name:"Scrll<br>Lock",desc:"Scroll Lock"},KC_PAUS:{name:"Pause",desc:"Pause Break"},KC_INS:{name:"Ins",desc:"Insert"},KC_HOME:{name:"Home"},KC_PGUP:{name:"Page<br>Up",desc:"Page Up"},KC_DEL:{name:"Del"},KC_END:{name:"End"},KC_PGDN:{name:"Page<br>Dn",desc:"Page Down"},KC_RGHT:{name:"→",desc:"Right"},KC_LEFT:{name:"←",desc:"Left"},KC_DOWN:{name:"↓",desc:"Down"},KC_UP:{name:"↑",desc:"Up"},KC_NLCK:{name:"Num<br>Lock",desc:"Num Lock"},KC_PSLS:{name:"/",desc:"Keypad /"},KC_PAST:{name:"*",desc:"Keypad *"},KC_PMNS:{name:"-",desc:"Keypad -"},KC_PPLS:{name:"+",desc:"Keypad +"},KC_PENT:{name:"P↩",desc:"Keypad Enter"},KC_P1:{name:'1<br><span class="fs10">End</span>',desc:"Keypad 1"},KC_P2:{name:"2<br>↓",desc:"Keypad 2"},KC_P3:{name:'3<br><span class="fs10">PgDn</span>',desc:"Keypad 3"},KC_P4:{name:"4<br>←",desc:"Keypad 4"},KC_P5:{name:"5",desc:"Keypad 5"},KC_P6:{name:"6<br>→",desc:"Keypad 6"},KC_P7:{name:'7<br><span class="fs10">Home</span>',desc:"Keypad 7"},KC_P8:{name:"8<br>↑",desc:"Keypad 8"},KC_P9:{name:'9<br><span class="fs10">PgUp</span>',desc:"Keypad 9"},KC_P0:{name:'0<br><span class="fs10">Ins</span>',desc:"Keypad 0"},KC_PDOT:{name:'.<br><span class="fs10">Del</span>',desc:"Keypad ."},KC_NUBS:{name:"|<sub>ISO</sub><br>\\",desc:"|\\ for ISO layout"},KC_APP:{name:"Menu",desc:"Menu on Win"},KC_POWER:{name:"Power",desc:"Power(work on Mac)"},KC_PEQL:{name:"=",desc:"Keymapd Equal(Not work on Win)"},KC_F13:{name:"F13"},KC_F14:{name:"F14"},KC_F15:{name:"F15"},KC_F16:{name:"F16"},KC_F17:{name:"F17"},KC_F18:{name:"F18"},KC_F19:{name:"F19"},KC_F20:{name:"F20"},KC_F21:{name:"F21"},KC_F22:{name:"F22"},KC_F23:{name:"F23"},KC_F24:{name:"F24"},KC_EXECUTE:{name:"KC_EXECUTE"},KC_HELP:{name:"KC_HELP"},KC_MENU:{name:"KC_MENU"},KC_SELECT:{name:"KC_SELECT"},KC_STOP:{name:"KC_STOP"},KC_AGAIN:{name:"KC_AGAIN"},KC_UNDO:{name:"F24"},KC_CUT:{name:"KC_CUT"},KC_COPY:{name:"KC_COPY"},KC_PASTE:{name:"KC_PASTE"},KC_FIND:{name:"KC_FIND"},KC_LCAP:{name:"Lock Caps",desc:"Locking Caps Lock"},KC_LNUM:{name:"Lock Num",desc:"Locking Num Lock"},KC_LSCR:{name:"Lock Scroll",desc:"Locking Scroll Lock"},KC_PCMM:{name:"KC_PCMM"},KC_KP_EQUAL_AS400:{name:"KC_KP_EQUAL_AS400"},KC_RO:{name:"JIS ろ",desc:"Japanese RO"},KC_KANA:{name:"ひらがな",desc:"Japanese Hiragana"},KC_JYEN:{name:"JIS ￥",desc:"Japanese Yen"},KC_HENK:{name:"変換",desc:"Japanese Henkan"},KC_MHEN:{name:"無変換",desc:"Japanese Muhenkan"},KC_INT6:{name:"INT6"},KC_INT7:{name:"INT7"},KC_INT8:{name:"INT8"},KC_INT9:{name:"INT9"},KC_HAEN:{name:"한/영",desc:"Korean Hangul/English"},KC_HANJ:{name:"한자",desc:"Korean Hanja"},KC_LANG3:{name:"LANG3"},KC_LANG4:{name:"LANG4"},KC_LANG5:{name:"LANG5"},KC_LANG6:{name:"LANG6"},KC_LANG7:{name:"LANG7"},KC_LANG8:{name:"LANG8"},KC_LANG9:{name:"LANG9"},KC_ERAS:{name:"KC_ERAS"},KC_SYSREQ:{name:"KC_SYSREQ"},KC_CANCEL:{name:"KC_CANCEL"},KC_CLR:{name:"KC_CLR"},KC_CLEAR:{name:"KC_CLEAR"},KC_PRIOR:{name:"KC_PRIOR"},KC_OUT:{name:"KC_OUT"},KC_OPER:{name:"KC_OPER"},KC_CLEAR_AGAIN:{name:"KC_CLEAR_AGAIN"},KC_CRSEL:{name:"KC_CRSEL"},KC_EXSEL:{name:"KC_EXSEL"},KC_PWR:{name:'<i class="i_system_power fs32"></i>',desc:"System Power，适合Win10，仅有线模式下有效"},KC_SLEP:{name:'<i class="i_system_sleep fs32"></i>',desc:"System Sleep，仅有线模式下有效"},KC_WAKE:{name:'<i class="i_system_wake fs32"></i>',desc:"System Wake，仅有线模式下有效"},KC_MUTE:{name:' <i class="kb kb-Multimedia-Mute-2 fs20"/>',desc:"静音"},KC_VOLU:{name:' <i class="kb kb-Multimedia-Volume-Up-2 fs20"/>',desc:"音量加"},KC_VOLD:{name:' <i class="kb kb-Multimedia-Volume-Down-2 fs20"/>',desc:"音量减"},KC_MNXT:{name:' <i class="fa fa-step-forward fs20"/>',desc:"下一曲"},KC_MPRV:{name:' <i class="fa fa-step-backward fs20"/>',desc:"上一曲"},KC_MSTP:{name:' <i class="fa fa-stop fs20"/>',desc:"停止播放"},KC_MPLY:{name:' <i class="fa fa-play fs20"/>',desc:"播放/暂停"},KC_MSEL:{name:' <i class="fa fa-music fs20"/>',desc:"启动默认音乐播放器"},KC_EJCT:{name:' <i class="material-icons fs22">keyboard_hide</i>',desc:"显示或隐藏iOS/iPadOS虚拟键盘"},KC_MAIL:{name:' <i class="fa fa-envelope fs20"></i>',desc:"邮件"},KC_CALC:{name:' <i class="fa fa-calculator fs22"/>',desc:"计算器，仅Windows下有效"},KC_MYCM:{name:' <i class="fa fa-desktop fs20"></i>',desc:"资源管理器，仅Windows下有效"},KC_WWW_SEARCH:{name:'<i class="i_www_search fs32"></i>',desc:"浏览器： 搜索"},KC_WWW_HOME:{name:'<i class="i_www_home fs32"></i>',desc:"浏览器： 主页"},KC_WWW_BACK:{name:'<i class="i_www_back fs32"></i>',desc:"浏览器： 后退"},KC_WWW_FORWARD:{name:'<i class="i_www_forward fs32"></i>',desc:"浏览器： 前进"},KC_WWW_STOP:{name:'<i class="i_www_stop fs32"></i>',desc:"浏览器： 停止"},KC_WWW_REFRESH:{name:'<i class="i_www_refresh fs32"></i>',desc:"浏览器： 刷新"},KC_WWW_FAVORITES:{name:'<i class="i_www_favorites fs32"></i>',desc:"浏览器： 收藏夹"},KC_MFFD:{name:"Fast Forward",desc:"Media Fast Forward(Mac)"},KC_MRWD:{name:"Rewind",desc:"Media Rewind(Mac)"},KC_BRIU:{name:' <i style="padding-left:6px" class="kb kb-Unicode-Screen-Bright fs24"/>',desc:"增大屏幕亮度，需要设备本身支持此功能，系统要求win8以上/Mac/iOS/iPadOS"},KC_BRID:{name:' <i style="padding-left:6px" class="kb kb-Unicode-Screen-Dim fs24"/>',desc:"降低屏幕亮度，需要设备本身支持此功能，系统要求win8以上/Mac/iOS/iPadOS"},KC_LCTL:{name:"Ctrl",desc:"Left Control"},KC_LSFT:{name:"Shift",desc:"Left Shift"},KC_LALT:{name:"Alt",desc:"Left Alt"},KC_LGUI:{name:"Win",desc:"Left Windows"},KC_RCTL:{name:"rCtrl",desc:"Right Control"},KC_RSFT:{name:"rShift",desc:"Right Shift"},KC_RALT:{name:"rAlt",desc:"Right Alt"},KC_RGUI:{name:"rWin",desc:"Right Windows"},KC_MS_UP:{name:'<i class="i_mouse_move_up fs32"></i>',desc:"鼠标： 上移"},KC_MS_DOWN:{name:'<i class="i_mouse_move_down fs32"></i>',desc:"鼠标： 下移"},KC_MS_LEFT:{name:'<i class="i_mouse_move_left fs32"></i>',desc:"鼠标： 左移"},KC_MS_RIGHT:{name:'<i class="i_mouse_move_right fs32"></i>',desc:"鼠标： 右移"},KC_MS_BTN1:{name:'<i class="i_mouse_left fs32"></i>',desc:"鼠标: 点击左键"},KC_MS_BTN2:{name:'<i class="i_mouse_right fs32"></i>',desc:"鼠标: 点击右键"},KC_MS_BTN3:{name:'<i class="i_mouse_middle fs32"></i>',desc:"鼠标: 点击中键"},KC_MS_BTN4:{name:'<i class="i_mouse_back fs32"></i>',desc:"鼠标: 点击后退"},KC_MS_BTN5:{name:'<i class="i_mouse_forward fs32"></i>',desc:"鼠标: 点击前进"},KC_MS_WH_UP:{name:'<i class="i_mouse_wheel_up fs32"></i>',desc:"鼠标: 滚轮 上"},KC_MS_WH_DOWN:{name:'<i class="i_mouse_wheel_down fs32"></i>',desc:"鼠标: 滚轮 下"},KC_MS_WH_LEFT:{name:'<i class="i_mouse_wheel_left fs32"></i>',desc:"鼠标: 滚轮 左"},KC_MS_WH_RIGHT:{name:'<i class="i_mouse_wheel_right fs32"></i>',desc:"鼠标: 滚轮 右"},KC_MS_ACCEL0:{name:'<i class="i_mouse_speed_slow fs32"></i>',desc:'按住此键，再按鼠标移动键时，鼠标指针"慢速"匀速移动'},KC_MS_ACCEL1:{name:'<i class="i_mouse_speed_medium fs32"></i>',desc:'按住此键，再按鼠标移动键时，鼠标指针"中速"匀速移动'},KC_MS_ACCEL2:{name:'<i class="i_mouse_speed_fast fs32"></i>',desc:'按住此键，再按鼠标移动键时，鼠标指针"快速"匀速移动'},KC_GESC:{name:"~<br>Esc",desc:"Esc normally, but ~ when Shift or GUl is pressed"},BL_TOGG:{name:"BL Toggle"},BL_ON:{name:"BL On"},BL_OFF:{name:"BL Off"},BL_DEC:{name:"BL -"},BL_INC:{name:"BL +"},BL_STEP:{name:"BL Cycle"},BL_BRTG:{name:"BR Toggle"},RGB_TOG:{name:'<i class="fa fa-toggle-on fs18"></i><br>RGB',desc:"RGB Toggle"},RGB_RMOD:{name:'<i class="fa fa-angle-double-left fs18"></i><br>RGB',desc:"RGB Mode-"},RGB_MOD:{name:'<i class="fa fa-angle-double-right fs18"></i><br>RGB',desc:"RGB Mode+"},RGB_HUD:{name:'<i class="fa fa-angle-double-down fs18"></i><br>HUE',desc:"RGB Hue -"},RGB_HUI:{name:'<i class="fa fa-angle-double-up fs18"></i><br>HUE',desc:"RGB Hue +"},RGB_SAD:{name:'<i class="fa fa-angle-double-down fs18"></i><br>SAT',desc:"RGB Saturation -"},RGB_SAI:{name:'<i class="fa fa-angle-double-up fs18"></i><br>SAT',desc:"RGB Saturation +"},RGB_VAD:{name:'<i class="fa fa-angle-double-down fs18"></i><br>LUM',desc:"RGB Brighness -"},RGB_VAI:{name:'<i class="fa fa-angle-double-up fs18"></i><br>Lum',desc:"RGB Brightness +"},RGB_SPD:{name:'<i class="fa fa-angle-double-down fs18"></i><br>Speed',desc:"RGB Effect Speed-"},RGB_SPI:{name:'<i class="fa fa-angle-double-up fs18"></i><br>Speed',desc:"RGB Effect Speed+"},RGB_M_P:{name:"RGB M_P",desc:"Plain"},RGB_M_B:{name:"RGB M_B",desc:"Breathe"},RGB_M_R:{name:"RGB M_R",desc:"Rainbow"},RGB_M_SW:{name:"RGB M_SW",desc:"Swirl"},RGB_M_SN:{name:"RGB M_SN",desc:"Snake"},RGB_M_K:{name:"RGB M_K",desc:"Knight"},RGB_M_X:{name:"RGB M_X",desc:"Xmas"},RGB_M_G:{name:"RGB M_G",desc:"Gradient"}},qkActionInfoDefault={_QK_MODS:{name:"{1}",desc:"修饰键<kt>{1}</kt>"},_QK_MOD_TAP:{name:"{1}<br>{2}",desc:"修饰键<kt>{1}</kt>, 单击是按键<kt>{2}</kt>"},_QK_LAYER_TAP:{name:"LT{0}<br>{2}",desc:"层<kt>{0}</kt>, 单击是按键<kt>{2}</kt>"},_QK_LAYER_MOD:{name:"LM{0}<br>{1}",desc:"瞬时开启层<kt>{0}</kt>，同时按下修饰键<kt>{1}</kt>"},_QK_TO:{name:"To{0}",desc:"跳转到层<kt>{0}</kt>"},_QK_MOMENTARY:{name:"L{0}",desc:"瞬时打开层<kt>{0}</kt>"},_QK_DEF_LAYER:{name:"DF{0}",desc:"设置默认层<kt>{0}</kt>"},_QK_TOGGLE_LAYER:{name:"TG{0}",desc:"切换层开关<kt>{0}</kt>"},_QK_ONE_SHOT_LAYER:{name:"OSL<br>L{0}",desc:"Momentarily activates <kt>Layer {0}</kt> until a key is pressed."},_QK_ONE_SHOT_MOD:{name:"OSM<br>{1}",desc:"Enable <kt>{1}</kt> for one keypress"},_QK_LAYER_TAP_TOGGLE:{name:"TT{0}",desc:"长按瞬时开启<kt>{0}</kt>，单击切换层<kt>{0}</kt>开关"},_QK_MACRO:{name:"Marco{0}",desc:"宏{0}"},_QK_KB:{name:"User{0}",desc:"User{0}"}},action_kinds={KEY:{id:"KEY",name:"常规按键",desc:"常规按键，右击查看帮助",link:"normal-key"},MODS_KEY:{id:"MODS_KEY",name:"修饰键（组合键）",desc:"修饰键，指ctrl shift alt(option) win(command)这些，右击查看帮助",link:"mods-key"},LAYER_MOMENTARY:{id:"LAYER_MOMENTARY",name:"瞬时开启层",desc:"按下按键时瞬时开启层，放开按键时层会关闭，右击查看帮助",link:"l-layer"},LAYER_TOGGLE:{id:"LAYER_TOGGLE",name:"层开关",desc:"切换层开关，右击查看帮助",link:"t-layer"},DEFAULT_LAYER_SET:{id:"DEFAULT_LAYER_SET",name:"设置默认层",desc:"设置一个层为默认层，右击查看帮助",link:"default-layer-set"},LAUNCH_SHORTCUT:{id:"LAUNCH_SHORTCUT",name:"启动快捷方式",desc:"启动一个快捷方式(仅支持windows)，右击查看帮助",link:"features/shortcut"},OPT_GROUP2:{id:"OPT_GROUP2",name:"Tap二合一功能按键 ▼",desc:"Tap二合一功能按键"},MODS_TAP_KEY:{id:"MODS_TAP_KEY",name:"按键 | 修饰键(s)",desc:"单击时是按键，长按及和其他键组合时是修饰键，右击查看帮助",link:"mods-tap-key"},MODS_TAP_KFT:{id:"MODS_TAP_KFT",name:"按键(k) | 修饰键",desc:"单击时是按键(且优先，即工作在非Interrupt模式下)，长按时是修饰键，右击查看帮助",link:"mods-tap-key"},LAYER_TAP_KEY:{id:"LAYER_TAP_KEY",name:"按键 | 瞬时开启层",desc:"单击是按键，长按及和其他键组合时是瞬时开启层，右击查看帮助",link:"layer-tap-key"},LAYER_TAP_TOGGLE:{id:"LAYER_TAP_TOGGLE",name:"层开关 | 瞬时开启层",desc:"瞬时开启层，如果连续点击数次时开关层，右击查看帮助",link:"lt-layer"},LAYER_MODS:{id:"LAYER_MODS",name:"修饰键 & 瞬时开启层",desc:"瞬时开启层的同时按下修饰键(目前仅支持左修饰键)，右击查看帮助",link:"layer-mods"},UNKNOWN:{id:"UNKNOWN",name:"其他",desc:"用于显示特殊功能，或该键盘不支持的功能",link:""}};Object.freeze(action_kinds),stdKeyCodes1={0:{id:"NO",name:'<i class="fa fa-ban fs22"></i>',desc:"当前层禁用此按键。也可用<kt>shift</kt>+<kt>鼠标中键</kt>点击设置"},1:{id:"TRNS",name:"▽",desc:"当前层此按键穿透到更低层。可用<kt>鼠标中键</kt>点击按键设置"},2:{id:"POST_FAIL",name:"POST_FAIL",desc:"POST_FAIL"},3:{id:"UNDEFINED",name:"UNDEFINED",desc:"UNDEFINED"},4:{id:"A",name:"A",desc:"A"},5:{id:"B",name:"B",desc:"B"},6:{id:"C",name:"C",desc:"C"},7:{id:"D",name:"D",desc:"D"},8:{id:"E",name:"E",desc:"E"},9:{id:"F",name:"F",desc:"F"},10:{id:"G",name:"G",desc:"G"},11:{id:"H",name:"H",desc:"H"},12:{id:"I",name:"I",desc:"I"},13:{id:"J",name:"J",desc:"J"},14:{id:"K",name:"K",desc:"K"},15:{id:"L",name:"L",desc:"L"},16:{id:"M",name:"M",desc:"M"},17:{id:"N",name:"N",desc:"N"},18:{id:"O",name:"O",desc:"O"},19:{id:"P",name:"P",desc:"P"},20:{id:"Q",name:"Q",desc:"Q"},21:{id:"R",name:"R",desc:"R"},22:{id:"S",name:"S",desc:"S"},23:{id:"T",name:"T",desc:"T"},24:{id:"U",name:"U",desc:"U"},25:{id:"V",name:"V",desc:"V"},26:{id:"W",name:"W",desc:"W"},27:{id:"X",name:"X",desc:"X"},28:{id:"Y",name:"Y",desc:"Y"},29:{id:"Z",name:"Z",desc:"Z"},30:{id:"1",name:"!<br>1",desc:"1 !"},31:{id:"2",name:"@<br>2",desc:"2 @"},32:{id:"3",name:"#<br>3",desc:"3 #"},33:{id:"4",name:"$<br>4",desc:"4 $"},34:{id:"5",name:"%<br>5",desc:"5 %"},35:{id:"6",name:"^<br>6",desc:"6 ^"},36:{id:"7",name:"&<br>7",desc:"7 &"},37:{id:"8",name:"*<br>8",desc:"8 *"},38:{id:"9",name:"(<br>9",desc:"9 ("},39:{id:"0",name:")<br>0",desc:"0 )"},40:{id:"ENT",name:"Enter",desc:"Enter"},41:{id:"ESC",name:"Esc",desc:"Esc"},42:{id:"BSPC",name:"Backspace",desc:"Backspace"},43:{id:"TAB",name:"Tab",desc:"Tab"},44:{id:"SPC",name:"Space",desc:"Space"},45:{id:"MINS",name:"_<br>-",desc:"- _"},46:{id:"EQL",name:"+<br>=",desc:"= +"},47:{id:"LBRC",name:"{<br>[",desc:"[ {"},48:{id:"RBRC",name:"}<br>]",desc:"] }"},49:{id:"BSLS",name:"|<br>\\",desc:"\\ |"},50:{id:"NUHS",name:"~<br>#",desc:"ISO ~#"},51:{id:"SCLN",name:":<br>;",desc:"; :"},52:{id:"QUOT",name:"\"<br>'",desc:"' \""},53:{id:"GRV ",name:"~<br>`",desc:"` ~"},54:{id:"COMM",name:"<<br>,",desc:", <"},55:{id:"DOT ",name:"><br>.",desc:". >"},56:{id:"SLSH",name:"?<br>/",desc:"/ ?"},57:{id:"CAPS",name:"Caps Lock",desc:"CapsLock"},58:{id:"F1  ",name:"F1",desc:"F1"},59:{id:"F2  ",name:"F2",desc:"F2"},60:{id:"F3  ",name:"F3",desc:"F3"},61:{id:"F4  ",name:"F4",desc:"F4"},62:{id:"F5  ",name:"F5",desc:"F5"},63:{id:"F6  ",name:"F6",desc:"F6"},64:{id:"F7  ",name:"F7",desc:"F7"},65:{id:"F8  ",name:"F8",desc:"F8"},66:{id:"F9  ",name:"F9",desc:"F9"},67:{id:"F10 ",name:"F10",desc:"F10"},68:{id:"F11 ",name:"F11",desc:"F11"},69:{id:"F12 ",name:"F12",desc:"F12"},70:{id:"PSCR",name:"Print<br>Scrn",desc:"Print Screen"},71:{id:"SLCK",name:"Scrll<br>Lock",desc:"Scroll Lock"},72:{id:"PAUS",name:"Pause",desc:"Pause Break"},73:{id:"INS ",name:"Ins",desc:"Insert"},74:{id:"HOME",name:"Home",desc:"Home"},75:{id:"PGUP",name:"Page<br>Up",desc:"Page Up"},76:{id:"DEL ",name:"Del",desc:"Del"},77:{id:"END ",name:"End",desc:"End"},78:{id:"PGDN",name:"Page<br>Dn",desc:"Page Down"},79:{id:"RGHT",name:"→",desc:"Right"},80:{id:"LEFT",name:"←",desc:"Left"},81:{id:"DOWN",name:"↓",desc:"Down"},82:{id:"UP  ",name:"↑",desc:"Up"},83:{id:"NLCK",name:"Num<br>Lock",desc:"Num Lock"},84:{id:"PSLS",name:"/",desc:"Keypad /"},85:{id:"PAST",name:"*",desc:"Keypad *"},86:{id:"PMNS",name:"-",desc:"Keypad -"},87:{id:"PPLS",name:"+",desc:"Keypad +"},88:{id:"PENT",name:"P↩",desc:"Keypad Enter"},89:{id:"P1  ",name:'1<br><span class="fs10">End</span>',desc:"Keypad 1"},90:{id:"P2  ",name:"2<br>↓",desc:"Keypad 2"},91:{id:"P3  ",name:'3<br><span class="fs10">PgDn</span>',desc:"Keypad 3"},92:{id:"P4  ",name:"4<br>←",desc:"Keypad 4"},93:{id:"P5  ",name:"5",desc:"Keypad 5"},94:{id:"P6  ",name:"6<br>→",desc:"Keypad 6"},95:{id:"P7  ",name:'7<br><span class="fs10">Home</span>',desc:"Keypad 7"},96:{id:"P8  ",name:"8<br>↑",desc:"Keypad 8"},97:{id:"P9  ",name:'9<br><span class="fs10">PgUp</span>',desc:"Keypad 9"},98:{id:"P0  ",name:'0<br><span class="fs10">Ins</span>',desc:"Keypad 0"},99:{id:"PDOT",name:'.<br><span class="fs10">Del</span>',desc:"Keypad ."},100:{id:"NUBS",name:"|<sub>ISO</sub><br>\\",desc:"|\\ for ISO layout"},101:{id:"APP ",name:"Menu",desc:"Menu on Win"},102:{id:"POWER",name:"Power",desc:"Power(work on Mac)"},103:{id:"PEQL",name:"=",desc:"Keymapd Equal(Not work on Win)"},104:{id:"F13 ",name:"F13",desc:"F13"},105:{id:"F14 ",name:"F14",desc:"F14"},106:{id:"F15 ",name:"F15",desc:"F15"},107:{id:"F16 ",name:"F16",desc:"F16"},108:{id:"F17 ",name:"F17",desc:"F17"},109:{id:"F18 ",name:"F18",desc:"F18"},110:{id:"F19 ",name:"F19",desc:"F19"},111:{id:"F20 ",name:"F20",desc:"F20"},112:{id:"F21 ",name:"F21",desc:"F21"},113:{id:"F22 ",name:"F22",desc:"F22"},114:{id:"F23 ",name:"F23",desc:"F23"},115:{id:"F24 ",name:"F24",desc:"F24"},130:{id:"LCAP",name:"Locking Caps Lock",desc:"Locking Caps Lock"},131:{id:"LNUM",name:"Locking Num Lock",desc:"Locking Num Lock"},132:{id:"LSCR",name:"Locking Scroll Lock",desc:"Locking Scroll Lock"},135:{id:"INT1",name:"JIS ろ",desc:"Japanese RO"},136:{id:"INT2",name:"ひらがな",desc:"Japanese Hiragana"},137:{id:"INT3",name:"JIS ￥",desc:"Japanese Yen"},138:{id:"INT4",name:"変換",desc:"Japanese Henkan"},139:{id:"INT5",name:"無変換",desc:"Japanese Muhenkan"},140:{id:"INT6",name:"INT6",desc:"INT6"},141:{id:"INT7",name:"INT7",desc:"INT7"},142:{id:"INT8",name:"INT8",desc:"INT8"},143:{id:"INT9",name:"INT9",desc:"INT9"},144:{id:"LANG1",name:"한/영",desc:"Korean Hangul/English"},145:{id:"LANG2",name:"한자",desc:"Korean Hanja"},146:{id:"LANG3",name:"LANG3",desc:"LANG3"},147:{id:"LANG4",name:"LANG4",desc:"LANG4"},148:{id:"LANG5",name:"LANG5",desc:"LANG5"},149:{id:"LANG6",name:"LANG6",desc:"LANG6"},150:{id:"LANG7",name:"LANG7",desc:"LANG7"},151:{id:"LANG8",name:"LANG8",desc:"LANG8"},152:{id:"LANG9",name:"LANG9",desc:"LANG9"},176:{id:"P00",name:"00",desc:"Keypad 00, 极少数键盘未支持此功能"},224:{id:"LCTL",name:"Ctrl",desc:"Left Control"},225:{id:"LSFT",name:"Shift",desc:"Left Shift"},226:{id:"LALT",name:"Alt",desc:"Left Alt"},227:{id:"LGUI",name:"Win",desc:"Left Windows"},228:{id:"RCTL",name:"rCtrl",desc:"Right Control"},229:{id:"RSFT",name:"rShift",desc:"Right Shift"},230:{id:"RALT",name:"rAlt",desc:"Right Alt"},231:{id:"RGUI",name:"rWin",desc:"Right Windows"}};var dsaKeyCodes={79:{id:"RGHT",name:'<i class="fa fa-arrow-right"/>',desc:"Right"},80:{id:"LEFT",name:'<i class="fa fa-arrow-left"/>',desc:"Left"},81:{id:"DOWN",name:'<i class="fa fa-arrow-down"/>',desc:"Down"},82:{id:"UP  ",name:'<i class="fa fa-arrow-up"/>',desc:"Up"},84:{id:"PSLS",name:"÷",desc:"Keypad /"},85:{id:"PAST",name:"×",desc:"Keypad *"},89:{id:"P1  ",name:"1",desc:"Keypad 1"},90:{id:"P2  ",name:"2",desc:"Keypad 2"},91:{id:"P3  ",name:"3",desc:"Keypad 3"},92:{id:"P4  ",name:"4",desc:"Keypad 4"},94:{id:"P6  ",name:"6",desc:"Keypad 6"},95:{id:"P7  ",name:"7",desc:"Keypad 7"},96:{id:"P8  ",name:"8",desc:"Keypad 8"},97:{id:"P9  ",name:"9",desc:"Keypad 9"},98:{id:"P0  ",name:"0",desc:"Keypad 0"},99:{id:"PDOT",name:".",desc:"Keypad ."}},extraKeyCodes={168:{id:"Mute",name:' <i class="kb kb-Multimedia-Mute-2 fs20"/>',desc:"静音"},169:{id:"Vol Up",name:' <i class="kb kb-Multimedia-Volume-Up-2 fs20"/>',desc:"音量加"},170:{id:"Vol Down",name:' <i class="kb kb-Multimedia-Volume-Down-2 fs20"/>',desc:"音量减"},240:{id:"MouseUp",name:'<i class="i_mouse_move_up fs24"></i>',desc:"鼠标： 上移"},241:{id:"MouseDown",name:'<i class="i_mouse_move_down fs24"></i>',desc:"鼠标： 下移"},242:{id:"MouseLeft",name:'<i class="i_mouse_move_left fs24"></i>',desc:"鼠标： 左移"},243:{id:"MouseRight",name:'<i class="i_mouse_move_right fs24"></i>',desc:"鼠标： 右移"},244:{id:"MouseLBtn",name:'<i class="i_mouse_left fs24"></i>',desc:"鼠标: 点击左键"},245:{id:"MouseRBtn",name:'<i class="i_mouse_right fs24"></i>',desc:"鼠标: 点击右键"},246:{id:"MouseMBtn",name:'<i class="i_mouse_middle fs24"></i>',desc:"鼠标: 点击中键"},247:{id:"MouseBack",name:'<i class="i_mouse_back fs24"></i>',desc:"鼠标: 点击后退"},248:{id:"MousePrev",name:'<i class="i_mouse_forward fs24"></i>',desc:"鼠标: 点击前进"},249:{id:"WheelUp",name:'<i class="i_mouse_wheel_up fs24"></i>',desc:"鼠标: 滚轮 上"},250:{id:"WheelDown",name:'<i class="i_mouse_wheel_down fs24"></i>',desc:"鼠标: 滚轮 下"},251:{id:"WheelLeft",name:'<i class="i_mouse_wheel_left fs24"></i>',desc:"鼠标: 滚轮 左"},252:{id:"WheelRight",name:'<i class="i_mouse_wheel_right fs24"></i>',desc:"鼠标: 滚轮 右"}},extra_keyCodes={358:{id:"MAC_POWER_MENU",name:'<i class="i_mac_powermenu fs32"></i>',desc:"Mac Only: 显示一个对话框，询问您是要重新启动、睡眠还是关机"},870:{id:"MAC_SCREENOFF",name:'<i class="i_mac_display_off fs32"></i>',desc:"Mac Only: 将显示器置于睡眠状态"},3174:{id:"MAC_SLEEP",name:'<i class="i_mac_powersleep fs32"></i>',desc:"Mac Only: 将您的 Mac 置于睡眠状态"},1705:{id:"VOL_UP_DIV4",name:'<i class="kb kb-Multimedia-Volume-Up-2 fs16"/>¼',desc:"Mac Only: 音量增加4分之1格"},1706:{id:"VOL_DN_DIV4",name:'<i class="kb kb-Multimedia-Volume-Down-2 fs16"/>¼',desc:"Mac Only: 音量减小4分之1格"}};function mousekey_codes(e){var a={240:{id:"MS_U",name:'<i class="i_mouse_move_up fs32"></i>',desc:"鼠标： 上移"},241:{id:"MS_D",name:'<i class="i_mouse_move_down fs32"></i>',desc:"鼠标： 下移"},242:{id:"MS_L",name:'<i class="i_mouse_move_left fs32"></i>',desc:"鼠标： 左移"},243:{id:"MS_R",name:'<i class="i_mouse_move_right fs32"></i>',desc:"鼠标： 右移"},244:{id:"BTN1",name:'<i class="i_mouse_left fs32"></i>',desc:"鼠标: 点击左键"},245:{id:"BTN2",name:'<i class="i_mouse_right fs32"></i>',desc:"鼠标: 点击右键"},246:{id:"BTN3",name:'<i class="i_mouse_middle fs32"></i>',desc:"鼠标: 点击中键"},247:{id:"BTN4",name:'<i class="i_mouse_back fs32"></i>',desc:"鼠标: 点击后退"},248:{id:"BTN5",name:'<i class="i_mouse_forward fs32"></i>',desc:"鼠标: 点击前进"},249:{id:"WH_U",name:'<i class="i_mouse_wheel_up fs32"></i>',desc:"鼠标: 滚轮 上"},250:{id:"WH_D",name:'<i class="i_mouse_wheel_down fs32"></i>',desc:"鼠标: 滚轮 下"},251:{id:"WH_L",name:'<i class="i_mouse_wheel_left fs32"></i>',desc:"鼠标: 滚轮 左"},252:{id:"WH_R",name:'<i class="i_mouse_wheel_right fs32"></i>',desc:"鼠标: 滚轮 右"},253:{id:"ACL0",name:'<i class="i_mouse_speed_slow fs32"></i>',desc:'按住此键，再按鼠标移动键时，鼠标指针"慢速"匀速移动'},254:{id:"ACL1",name:'<i class="i_mouse_speed_medium fs32"></i>',desc:'按住此键，再按鼠标移动键时，鼠标指针"中速"匀速移动'},255:{id:"ACL2",name:'<i class="i_mouse_speed_fast fs32"></i>',desc:'按住此键，再按鼠标移动键时，鼠标指针"快速"匀速移动'}};return a[e]?a[e]:0==e?{id:"BTN1_",name:"火力左键",desc:"火力模式按键 鼠标左键"}:e<=69?{id:stdKeyCodes[e].id,name:"火"+stdKeyCodes[e].id,desc:"火力模式按键 "+stdKeyCodes[e].desc}:void console.log(e)}function mods_codes(e){var a="",s=[];return 1&e&&(a+="⌃",s.push("Ctrl")),2&e&&(a+="⇧",s.push("Shift")),4&e&&(a+="⌥",s.push("Alt")),8&e&&(a+="⌘",s.push("Win")),s=s.join(" + "),1==a.length&&(a=s),16&e&&(a="r"+a,s="Right "+s),{name:a,desc:s}}function keyCode2tmkCode(e){var a={173:189,61:187,59:186,181:173,182:174,183:175,480:347,736:605};navigator.userAgent.indexOf("Firefox")>=0&&a[e]&&(e=a[e]);return{8:42,9:43,13:40,272:225,528:229,273:224,529:228,274:226,530:230,19:72,20:57,27:41,32:44,33:75,34:78,35:77,36:74,37:80,38:82,39:79,40:81,44:70,45:73,46:76,48:39,49:30,50:31,51:32,52:33,53:34,54:35,55:36,56:37,57:38,65:4,66:5,67:6,68:7,69:8,70:9,71:10,72:11,73:12,74:13,75:14,76:15,77:16,78:17,79:18,80:19,81:20,82:21,83:22,84:23,85:24,86:25,87:26,88:27,89:28,90:29,347:227,604:231,605:231,93:101,781:88,864:98,813:98,865:89,803:89,866:90,808:90,867:91,802:91,868:92,805:92,869:93,780:93,870:94,807:94,871:95,804:95,872:96,806:96,873:97,801:97,874:85,875:87,877:86,878:99,814:99,879:84,112:58,113:59,114:60,115:61,116:62,117:63,118:64,119:65,120:66,121:67,122:68,123:69,144:83,145:71,186:51,187:46,188:54,189:45,190:55,191:56,192:53,219:47,220:49,221:48,222:52,124:104,173:16610,174:16618,175:16617,183:16786,226:100}[e]}function keyName2tmkCode(e){if(keyUnimap={KANA:"00",VOLDN:"40EA",VOLUP:"40E9",MUTE:"40E2",CALC:"4192",A:"04",B:"05",C:"06",D:"07",E:"08",F:"09",G:"0A",H:"0B",I:"0C",J:"0D",K:"0E",L:"0F",M:"10",N:"11",O:"12",P:"13",Q:"14",R:"15",S:"16",T:"17",U:"18",V:"19",W:"1A",X:"1B",Y:"1C",Z:"1D",1:"1E",2:"1F",3:"20",4:"21",5:"22",6:"23",7:"24",8:"25",9:"26",0:"27",ENTER:"28",ESC:"29",BS:"2A",BACKSPACE:"2A",TAB:"2B",SPACE:"2C","-":"2D","=":"2E","[":"2F","]":"30","\\":"31","ISO#":"32",";":"33","'":"34","`":"35",",":"36",COMMA:"36",".":"37","/":"38",CAPSLOCK:"39","CAPS LOCK":"39",F1:"3A",F2:"3B",F3:"3C",F4:"3D",F5:"3E",F6:"3F",F7:"40",F8:"41",F9:"42",F10:"43",F11:"44",F12:"45",PRTSCR:"46","PRINT SCREEN":"46",SCRLK:"47","SCROLL LOCK":"47",PAUSE:"48","PAUSE BREAK":"48",INS:"49",INSERT:"49",HOME:"4A",PGUP:"4B","PAGE UP":"4B",DEL:"4C",DELETE:"4C",END:"4D",PGDN:"4E","PAGE DOWN":"4E",RIGHT:"4F",LEFT:"50",DOWN:"51",UP:"52","NUM LOCK":"53",NUMLK:"53",NUMLOCK:"53","P/":"54","P*":"55","P-":"56","P+":"57",PENTER:"58",P1:"59",P2:"5A",P3:"5B",P4:"5C",P5:"5D",P6:"5E",P7:"5F",P8:"60",P9:"61",P0:"62","P.":"63","ISO\\":"64",MENU:"65","P,":"66","P=":"67",F13:"68",F14:"69",F15:"6A",F16:"6B",F17:"6C",F18:"6D",F19:"6E",F20:"6F",F21:"70",F22:"71",F23:"72",F24:"73",JYEN:"74",RO:"75",HENK:"76",MHEN:"77",CTRL:"78",SHIFT:"79",ALT:"7A",WIN:"7B",RCTRL:"7C",RSHIFT:"7D",RALT:"7E",RWIN:"7F",NO:"80"},"number"==typeof e){for(var a in e>=224&&e<232&&(e-=104),keyUnimap)if(e==parseInt(keyUnimap[a],16))return a;console.log(e)}if(keyUnimap[e])return keyUnimap[e];console.log(keyUnimap[e])}function tmkCode2keyName(e){return keyName2tmkCode(e)}function shorten_date(e){var a=parseInt(e,10);return a<10?""+a:String.fromCharCode(a+55)}function keylabel_mac(e){return e=e.replace(/Del/i,"delete<i class='kb kb-Unicode-DeleteRight-Big fs12'></i>").replace(/Home/i,"home").replace(/End/i,"end").replace(/Page<br>Up/i,"page<br>up").replace(/Page<br>Dn/i,"page<br>dn").replace(/backspace|bs/i,"delete").replace(/caps lock/i,"caps<br>lock").replace(/tab/i,"tab").replace(/esc/i,"esc").replace(/enter/i,"return").replace(/space/i,"space").replace(/ctrl/i,"control").replace(/shift/i,"shift").replace(/alt/i,"option").replace(/left windows/i,"Left Command").replace(/right windows/i,"Left Command").replace(/win/i,"cmd").replace(/cmd⌘dows/i,"windows").replace(/print<br>scrn/i,"F13").replace(/scrll<br>lock/i,"F14").replace(/pause/i,"F15").replace(/ins/i,"help").replace(/p↩/i,"enter").replace(/p=/i,"=").replace(/num<br>lock/i,"clear")}system_codes=[],system_codes[129]={id:"PWR ",name:'<i class="i_system_power fs32"></i>',desc:"System Power，适合Win10，仅有线模式下有效"},system_codes[130]={id:"SLEP",name:'<i class="i_system_sleep fs32"></i>',desc:"System Sleep，仅有线模式下有效"},system_codes[131]={id:"WAKE",name:'<i class="i_system_wake fs32"></i>',desc:"System Wake，仅有线模式下有效"},Object.freeze(system_codes),consumer_codes={111:{id:"SBUP",name:' <i style="padding-left:6px" class="kb kb-Unicode-Screen-Bright fs24"/>',desc:"增大屏幕亮度，需要设备本身支持此功能，系统要求win8以上/Mac/iOS/iPadOS"},112:{id:"SBDN",name:' <i style="padding-left:6px" class="kb kb-Unicode-Screen-Dim fs24"/>',desc:"降低屏幕亮度，需要设备本身支持此功能，系统要求win8以上/Mac/iOS/iPadOS"},226:{id:"MUTE",name:' <i class="kb kb-Multimedia-Mute-2 fs22"/>',desc:"静音"},233:{id:"VOLU",name:' <i class="kb kb-Multimedia-Volume-Up-2 fs22"/>',desc:"音量加"},234:{id:"VOLD",name:' <i class="kb kb-Multimedia-Volume-Down-2 fs22"/>',desc:"音量减"},181:{id:"MNXT",name:' <i class="fa fa-step-forward fs20"/>',desc:"下一曲"},182:{id:"MPRV",name:' <i class="fa fa-step-backward fs20"/>',desc:"上一曲"},183:{id:"MSTP",name:' <i class="fa fa-stop fs20"/>',desc:"停止播放"},184:{id:"EJCT",name:' <i class="material-icons fs22">keyboard_hide</i>',desc:"显示或隐藏iOS/iPadOS虚拟键盘"},205:{id:"MPLY",name:' <i class="fa fa-play fs20"/>',desc:"播放/暂停"},387:{id:"MSEL",name:' <i class="fa fa-music fs20"/>',desc:"启动默认音乐播放器"},394:{id:"MAIL",name:' <i class="fa fa-envelope fs20"></i>',desc:"邮件"},402:{id:"CALC",name:' <i class="fa fa-calculator fs22"/>',desc:"计算器，仅Windows下有效"},404:{id:"MYCM",name:' <i class="fa fa-desktop fs20"></i>',desc:"资源管理器，仅Windows下有效"},545:{id:"WSCH",name:'<i class="i_www_search fs32"></i>',desc:"浏览器： 搜索"},547:{id:"WHOM",name:'<i class="i_www_home fs32"></i>',desc:"浏览器： 主页"},548:{id:"WBAK",name:'<i class="i_www_back fs32"></i>',desc:"浏览器： 后退"},549:{id:"WFWD",name:'<i class="i_www_forward fs32"></i>',desc:"浏览器： 前进"},550:{id:"WSTP",name:'<i class="i_www_stop fs32"></i>',desc:"浏览器： 停止"},551:{id:"WREF",name:'<i class="i_www_refresh fs32"></i>',desc:"浏览器： 刷新"},554:{id:"WFAV",name:'<i class="i_www_favorites fs32"></i>',desc:"浏览器： 收藏夹"},179:{id:"MFFD",name:"Fast Forward",desc:"Media Fast Forward(Mac)"},180:{id:"MRWD",name:"Rewind",desc:"Media Rewind(Mac)"}},Object.freeze(consumer_codes),deviceFilters={filters:[{vendorId:22852,productId:9158,usagePage:65376}]},CONFIG={kbd:{V5944_P23C6:{name:"EE60",rows:5,cols:14,layout:"layout-ee60.html",case:{X:15,Y:5,MU:-24}},V5944_P23CB:{name:"HFKB US",rows:5,cols:14,layout:"layout-hfkb_us.html",case:{X:15,Y:5,MU:-24}},V5944_P24C1:{name:"H60EC",rows:5,cols:14,layout:"layout-h60ec.html",case:{X:15,Y:5,MU:-24}},V5944_P24C6:{name:"EE660C",rows:5,cols:15,layout:"layout-ee660.html",case:{X:16.5,Y:5,M:-18,BR:6}},V9D5B_P240B:{name:"Agar Keyboard",rows:14,cols:8,layout:"layout-kbdfans_agar.html",case:{X:15,Y:5,MU:-24}},V9D5B_P2502:{name:"AgarEC Keyboard",rows:5,cols:14,layout:"layout-kbdfans_agarec.html",case:{X:15,Y:5,MU:-24}}}};for(let e=8192;e<12288;e++){let a=[22852,40283];for(let s in a){let t=hex16(a[s],"V")+"_"+hex16(e,"P");if(CONFIG.kbd[t]){let t={vendorId:a[s],productId:e,usagePage:65376};deviceFilters.filters.push(t)}}}function update_copyright(){let e=(new Date).getFullYear()-2016,a=0,s=setInterval((function(){++a>=e&&clearInterval(s),$("#tyear").text(2016+a)}),1e3)}async function fetchHeader(e,a){return(await fetch(e)).headers.get(a)}function format_date(e){dateDigitToString=function(e){return e<10?"0"+e:e};let a=dateDigitToString(e.getFullYear()),s=dateDigitToString(e.getMonth()+1),t=dateDigitToString(e.getDate()),n=a+"-"+s+"-"+t+" "+dateDigitToString(e.getHours())+":"+dateDigitToString(e.getMinutes())+":"+dateDigitToString(e.getSeconds());return last_modified_date_short=shorten_date(a%100)+shorten_date(s)+shorten_date(t),console.log("Latest firmware: "+last_modified_date_short+" "+n),{short:last_modified_date_short,long:n}}function checkResponse(e){if(e.status>=200&&e.status<300)return e;{let a=new Error(e.statusText);throw a.response=e,a}}function parseTEXT(e){return e.text()}function parseJSON(e){return e.json()}KEYCAP_COLORS=[{name:"Hana",value:["#a598c5","#efefea"],case_color:"#ebc3f0"},{name:"HHKB",value:["#222222","#eae6e7","#cbcdda"],order:[0,1,0,2,0,2]},{name:"RF 10th",value:["#222222","#989793","#6688aa"],order:[0,1,0,2,0,2],case_color:"#333333"},{name:"Raindrop",value:["#0073a2","#e5e4df"]},{name:"Carbon",value:["#575d5e","#e3d9c6","#ed6b21"],order:[0,1,2,0,0,2],case_color:"#424848"},{name:"Honeywell",value:["#212224","#efefea","#575757","#b01c11"],order:[0,1,1,2,1,3]},{name:"Hyperfuse",value:["#6c3b7b","#c4c4c0","#5dceba","#63696a"],order:[0,1,2,3,2,3]},{name:"Granite",value:["#525554","#e6e8e3","#222222","#a0a4a7"],order:[0,1,2,3,2,3]},{name:"Jukebox",value:["#a51b1b","#d9c9a8","#69d0a5"],order:[0,1,0,2,1,0]},{name:"Valentine",value:["#dc90bc","#efefea"],case_color:"#eaa0ca"},{name:"EVA 01",value:["#93c247","#592254"]},{name:"Pulse",value:["#00a6b4","#212224"]},{name:"Royal Navy",value:["#2f3d6f","#f0f0f0","#a92f0d"],order:[0,1,1,0,1,2]},{name:"Dolch",value:["#e4dedd","#5f5c52","#333430","#00a4a9"],order:[0,1,0,2,0,3]},{name:"Classic Olivetti",value:["#0965ed","#f5f5f5","#cfcdc2"],order:[0,1,0,2,1,0]},{name:"Lime",value:["#93c247","#e5e4df","#7c878e"],order:[0,1,1,2,1,0]},{name:"Eve",value:["#333333","#d4d0c7","#2785db"],order:[0,1,2,0,1,2]},{name:"Godspeed",value:["#666666","#d3cdc1","#6a94b1","#f9eb74"],order:[0,1,1,2,0,3]},{name:"Bentō",value:["#487992","#fff4f0","#f8767e"],order:[0,1,2,0,1,2]},{name:"Jamón",value:["#f2ebd7","#8c303a","#b2343c","#424446"],order:[0,1,0,2,3,0]},{name:"White on Black",value:["#efefea","#222222"],order:[0,1,0,1,0,1]},{name:"βeta",value:["#333333","#dcd6c4","#727473","#dd7632"],order:[0,1,0,2,0,3]},{name:"DMG",value:["#1d1770","#d1cdca","#7f8389","#722158"],order:[0,1,0,2,1,3]},{name:"Shiko",value:["#7a99ac","#dde5ed","#a1d1ee"],order:[0,1,1,0,1,2]},{name:"Olivia++",value:["#222222","#e1dbd1","#373634","#e0b19f"],order:[0,1,3,2,0,3]},{name:"Olivia dark",value:["#e0b19f","#222222"],order:[0,1,0,1,1,0]},{name:"Oblivion",value:["#dedeca","#6b7273","#474946","#297fa9"],order:[0,1,0,2,0,3]},{name:"Oblivion W",value:["#dedeca","#e7e8e5","#474946","#297fa9"],order:[2,1,0,2,0,3]},{name:"Symbiosis",value:["#e5e4df","#747b7b","#0073a2","#ffac00"],order:[0,1,0,2,2,3],case_color:"c4d0d0"},{name:"Posh Blue",value:["#222d5a","#e1dbd1","#d8a0a6"],order:[0,1,2,0,0,2]},{name:"Posh Pink",value:["#222d5a","#e1dbd1","#d8a0a6"],order:[0,1,0,2,2,0]},{name:"Pitta",value:["#333333","#eee6d3","#ccc0a6","#3cdcc6"],order:[0,1,0,2,0,3]}],UI_THEME=[{name:"默认主题",color:"#0288d1"},{name:"红色主题",color:"#e57373"},{name:"粉色主题",color:"#f06292"},{name:"紫色主题",color:"#7e57c2"},{name:"青色主题",color:"#00acc1"},{name:"绿色主题",color:"#4caf50"},{name:"暗黑模式",color:"#242424"}],$((function(){$("#display-layout-info").click((function(){if(0==$("#user-keyboard").find(".keycap-length").length){let e=0,a=0;$("#user-keyboard").find(".key:visible").each((function(){let s=$(this).parents().parents().parents().attr("class"),t=s.match(/.*? w(\d+).*?/),n=s.match(/.*? h(\d+).*?/),o=s.match(/.*?round|square|keylarger150.*?/);t&&(t=t[1]/100);let i=$(this).parents().parents().parents().css("--width");if(i&&(t=parseFloat(i.replace("px",""))/56),!o){e++,1!=t||(t=n?n[1]/100:1);let s=0;if(1.5==t&&n&&200==n[1]&&(t+="/2",s=2),$(this).attr("length",t+"u"),t>=2&&t<=2.75?s=2:t>=3&&(s=t),s>0){let e=s+("zh_cn"==NOW_LANG?"u 卫星轴":"u stabilizer");$(this).attr("stabilizer",e)}let o=$(this);setTimeout((function(){o.attr("length")&&o.removeClass("fade-in-down fade-in-up").addClass("fade-out-down")}),15*e),setTimeout((function(){a++;let s=o.attr("length"),t=("<br>"+o.attr("stabilizer")).replace(/<br>undefined/,"");s&&(o.removeClass("fade-out-down").addClass("fade-in-down"),o.html(`<span class="keycap-length">${s}</span>${t}`),o.removeAttr("length stabilizer")),$("#this_layout_keys").text(a),a==e&&setTimeout((function(){$("#user-keyboard").find(".homing").find(".key").removeClass("fade-in-down fade-in-up")}),15)}),15*e+200)}})),$("#layout-info-pane").css("display","").removeClass("hidef").addClass("showf")}else $("#user-layer-tabs").tabs("select","layer-0"),load_keymap_on_keyboard(nowKBD.keymaps[editing_layer])}))})),String.prototype.format=function(){var e=this;for(var a in arguments){var s=new RegExp("\\{"+a+"\\}","gi");e=e.replace(s,arguments[a])}return e};let $jsonp=function(){let e={send:function(e,a){let s=a.callbackName||"callback",t=a.onSuccess||function(){},n=a.onTimeout||function(){},o=a.timeout||10,i=window.setTimeout((function(){window[s]=function(){},n()}),1e3*o);window[s]=function(e){window.clearTimeout(i),t(e)};let d=document.createElement("script");d.type="text/javascript",d.async=!0,d.src=e,document.getElementsByTagName("head")[0].appendChild(d),d.parentNode.removeChild(d)}};return e}();function fadeToggle(e,a=16.6){if(0==e.style.opacity){e.style.display="block";let s=0,t=setInterval((function(){s++,e.style.opacity=s/20,s>=20&&clearInterval(t)}),a)}else if(1==e.style.opacity){let s=20,t=setInterval((function(){s--,e.style.opacity=s/20,0==s&&(e.style.display="none",clearInterval(t))}),a)}}function add_some_css_to_head(){let e="";for(let a=8;a<=33;a++)e+=`.fs${a} {font-size: ${a}px;}`;for(let a=1;a<=30;a++)e+=`.key-set.spc${25*a} {margin-left:${50*a/4+4}px;}`;for(let a=1;a<=40;a++)e+=`.key-set.w${25*a} {width:${50*a/4-8}px;}`;for(let e=1;e<=100;e++);for(let e=1;e<=32;e++);for(let a=1;a<=100;a++)e+=`.kbdbg-inner.w${25*a} { width:${56*a/4+6}px; }`;for(let a=1;a<=28;a++)e+=`.kbdbg-inner.h${25*a} { height:${56*a/4+6}px; }`;for(let e=5;e<=32;e++);for(let e=5;e<=10;e++);addGlobalStyle(e)}function removeHTMLTags(e){return(e=e.replace(/<br>/g,"_")).replace(/<[^>]*>/g,"")}function addGlobalStyle(e){let a,s;a=document.getElementsByTagName("head")[0],a&&(s=document.createElement("style"),s.type="text/css",s.innerHTML=e,a.appendChild(s))}function getElementAbsPos(e){let a=e.getBoundingClientRect();return{left:a.left+window.scrollX,top:a.top+window.scrollY}}function ani_fly_button(e,a){let s=$("#user-keyboard").find(".key-editing");if(s.length>0){let t=s.find(".key");if(console.log(t),0==t.length&&(t=s.closest(".key")),0==t.length)return void console.log("ani_fly_button: "+s);$("#fly-button").removeClass("fly");let n=display_label(e,0),o=getElementAbsPos(t[0]);$("#fly-button").attr("style",`--fbs_left: ${a.left}px; --fbs_top: ${a.top}px; width:36px;height:36px;box-shadow:0px 0px 10px #ccc;--fbe_left: ${o.left}px; --fbe_top: ${o.top}px;--fbcolor: ${s.css("color")};--fbbgcolor: ${s.css("background")};`),$("#fly-button").html(n.name).addClass("fly"),play_sound("sound/key_set.wav")}}function play_sound(e){let a=new Audio(e);a.pause(),a.currentTime=0,a.play()}function hex8(e,a=""){return a+("0"+parseInt(e).toString(16)).toUpperCase().slice(-2)}function hex16(e,a=""){return a+("000"+parseInt(e).toString(16)).toUpperCase().slice(-4)}function parseNumber(e){return e.startsWith("0b")?parseInt(e.slice(2),2):e.startsWith("0x")?parseInt(e,16):e.startsWith("0o")?parseInt(e.slice(2),8):parseInt(e,10)}function deepFreeze(e){return Object.getOwnPropertyNames(e).forEach((a=>{const s=e[a];"object"==typeof s&&null!==s&&deepFreeze(s)})),Object.freeze(e)}function isNumber(e){return"[object Number]"===Object.prototype.toString.call(e)&&!isNaN(e)}function isString(e){return"[object String]"===Object.prototype.toString.call(e)}function str_to_data0(e,a){let s=[];for(let t=0;t<e.length;t++)s.push(e[t].charCodeAt(0)),0==a&&s.push(0);return s}function find_array_in_array(e,a,s){console.log(`%c_Find ${e} in size ${a.length}`,"color:green"),s<2&&(e=str_to_data0(e,s));let t=0;for(let s=0;s<a.length;s++){t=s;for(let s=0;s<e.length&&a[t]==e[s];s++)t++;if(t==s+e.length)return console.log(`%c_found, addr: ${s}`,"color:green"),{start:s,end:t}}return 0}function unzip(e){var a=atob(e),s=new pako.Inflate;if(s.push(a,!0),s.err)return null;var t=s.result;return strData=String.fromCharCode.apply(null,new Uint16Array(t)),strData}function zip(e){var a=pako.gzip(e,{to:"string"});return btoa(a)}function update_share_url_panel(){var e;$("#share-dialog").hasClass("url-long")?(e=parseInt($("#share-dialog")[0].style.getPropertyValue("--aug-r")))<80&&(e++,$("#share-dialog")[0].style.setProperty("--aug-r",e+"px"),setTimeout("update_share_url_panel()",10)):((e=parseInt($("#share-dialog")[0].style.getPropertyValue("--aug-r")))>60&&(e=60),e>12&&(e--,$("#share-dialog")[0].style.setProperty("--aug-r",e+"px"),setTimeout("update_share_url_panel()",10)))}String.prototype.replaceAll=function(e,a){return this.replace(new RegExp(e,"gm"),a)},function(e){jQuery.fn.extend({prependClass:function(a){return this.each((function(){let s=e(this).prop("class");e(this).removeClass(s).addClass(a+" "+s)}))}})}(jQuery);let is_mac=navigator.platform.includes("Mac");var kxxEditing,user_macrofn,now_case_color,now_case_style,user_layouts_i=0,select_kbd="1800mini",keyState=new Array(256).fill(0),editingLayer=0,keymaps_changed=!1,bottom_content_layer=255,now_keycap_style="gmk";iscasejscolor=0,layouts_save="";var mods=0;function load_select_kbd(e){var a=CONFIG.kbd[e];if(a){$("#firmware-dropdown-btn").html(`<i class="material-icons fl">keyboard</i>${a.name}`).attr({value:e}),$("#logo_name, #kbdinfo_tab_name").text(a.name),update_logo_desc(),a.layout||(a.layout=`./config/layout-${e}.html`),a.firmware_url||(a.fwbin?a.firmware_url=`./config/${e}.bin`:a.firmware_url=`./config/${e}.hex`),$("#layouts-set-div, #layouts-set-on2").hide(),$("#layouts-set-on").addClass("scale-out");var s=a.case;if(s){var t=s.M?s.M:s.MU?s.MU:-12,n=s.M?s.M:s.MD?s.MD:-12,o=56*s.Y-t-n+24;s.EY&&(o+=56*s.EY),s.MaskHeight&&(o=s.MaskHeight),$("#user-keyboard").html(`<div class="keyboard-mask page-wd" style="height: ${o}px;"></div><div style="height:${o-30}px;"</div>`);var i=56*s.Y/128,d=o/2-30,c=640;s.MaskHeight&&(c=640-1/(i=(s.MaskHeight-60)/128)*64),$("#loading").css({top:d+"px",left:c+"px",transform:`scale(${i})`}),$("#loading").show()}layout_load(a.layout)}}function tabs_init(){$(".tabs").tabs(),$("#top-tabs").tabs("select",'[value="top-keymaps"]'),$("#user-keymaps-tabs").tabs("select","#layer-0"),$("#setting-tabs").tabs("select","tabs-keys-basic")}function update_tab_indicator(e){M.Tabs.getInstance(e[0]).updateTabIndicator(),e.find(".indicator").html(e.find(".active").html())}indicator=Array(8).fill(0),indicator_color=Array(8).fill(0),lang_pre_action(),window.onfocus=function(){},window.onblur=function(){$("#tabs-keys-basic").find(".keydown").removeClass("keydown"),mods=0},$("#user-keycap-colors").bind("input propertychange",(function(){user_keycap_colors($(this).val())})),$("#top-tabs").on("click","li a",(function(){$("#top-tabs .indicator").html($(this).html())})),$(".tabs.chrome").on("click","li a",(function(){let e=$(this).html();$(this).closest(".tabs").find(".indicator").html(e)})),$("#layouts-set-border, #keycap_color-userset-border").drags(),$("#layouts-set-on, #layouts-set-off, #layouts-set-on2").click((function(){fadeToggle($("#layouts-set-border")[0])})),$("#keycap_color-userset-on, #keycap_color-userset-off").click((function(){fadeToggle($("#keycap_color-userset-border")[0])})),$("input.jscolor, textarea.not_drag").on("mousemove",(function(e){$(this).addClass("no_drag")})),$("input.jscolor, textarea.not_drag").on("mouseout",(function(e){$(this).removeClass("no_drag")})),$(document).ready((function(){for(var e of(process_html_page(),$(".collapsible").collapsible(),$(".modal").modal(),$(".dropdown-trigger").dropdown({coverTrigger:!1}),$("#keymap-load-dropdown-btn, #download-share-dropdown-btn").dropdown({constrainWidth:!1,coverTrigger:!1}),KEYCAP_COLORS)){e.order||(e.order=[0,1,1,0,1,0]);for(var a=new Array(0,0,0,0,0,0),s=0;s<6;s++)a[s]=e.value[e.order[s]];var t="";function n(e,a,s,t){return`<li class="key-color key-${e}" style="color:${a}; background:${s}">${t}</li>`}e.case_color&&(t=`case-color="${e.case_color}"`),$("#keycap-color-list").append(`<div class="keycap-color-block" ${t}>`+n("main",a[0],a[1],"key")+n("enter",a[4],a[5],"enter")+n("mod",a[2],a[3],e.name)+"</div>")}for(let o of UI_THEME)$("#ui-theme").append(`<li style="color:#fefefe; background-color:${o.color};"><a lang="zh_sc">${o.name}`);fetch("./common/case_list.txt").then(checkResponse).then(parseTEXT).then((function(e){let a=e.split("\n");a.pop();for(let e of a)$("#mycase-style ul").append(`<li style="background-image: url(./common/case/${e}"><a>`)})),jsdef_init(),display_system_change(is_mac),update_ui_color(),update_keycap_color(),update_keycap_style(),update_case_color(),update_case_style(),tabs_init()})),$(".fixed-action-btn.tips").on("click",".tip_redt",(function(e){e.shiftKey&e.altKey&&$("#layoutFile").trigger("click")})),$("#keycap-color-list").on("click",".keycap-color-block",(function(){now_keycap_color[0]=$(this).find(".key-main").css("color"),now_keycap_color[1]=$(this).find(".key-main").css("background"),now_keycap_color[2]=$(this).find(".key-mod").css("color"),now_keycap_color[3]=$(this).find(".key-mod").css("background"),now_keycap_color[4]=$(this).find(".key-enter").css("color"),now_keycap_color[5]=$(this).find(".key-enter").css("background");for(var e=0;e<6;e++){var a=now_keycap_color[e].match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/);a&&(now_keycap_color[e]=`#${hex8(a[1])}${hex8(a[2])}${hex8(a[3])}`)}update_keycap_color(now_keycap_color),iscasejscolor||(now_case_color=now_keycap_color[1],$(this).attr("case-color")&&(now_case_color=$(this).attr("case-color")),$.cookie&&$.cookie("ck_case_color",now_case_color,{expires:365,path:"/"}),update_case_color(now_case_color))})),$("#casejscolor-toggle").click((function(){iscasejscolor=$(this).prop("checked"),$("#casejscolor-btn")[0].type=iscasejscolor?"show":"hidden"})),$("#ui-theme").on("click","li",(function(){update_ui_color($(this).css("background-color"))})),$("[id^='layouts-']").on("click","[class^='layouts-']",(function(){var e=this.id.match(/layouts-(\d)(\d)/);if($("#kblayouts-00").length>0){for(var a=0;a<$("div[id^='kblayouts-"+e[1]+"']").length;a++)$("#user-keyboard").find(".layout-"+e[1]+a).hide(),$("#user-keyboard").find("[layout="+e[1]+a+"]").hide(),$("#user-keyboard").find("[layout="+e[1]+a+"]").hide(),$("#kblayouts-"+e[1]+a).hide();$("#user-keyboard").find(".layout-"+e[1]+e[2]).each((function(){$(this).show()})),$("#user-keyboard").find("[layout="+e[1]+e[2]+"]").show(),$("#kblayouts-"+e[1]+e[2]).show()}var s=layouts_save.match(/(\d)/g);layouts_save="",$("div[id^='kblayouts-']").each((function(){if("block"==$(this).css("display")){var e=this.id.match(/kblayouts-(\d)(\d)/),a=e[1],t=e[2];s[a]=t}}));for(a=0;a<s.length;a++)layouts_save+=s[a];keymaps[1][0][0]="1"+layouts_save>>16,keymaps[0][0][0]="1"+layouts_save&65535,$("#user-keyboard").find(".keyboard-mask").addClass("hidef"),load_keymap_on_keyboard()})),$("#mykeycap_change li a").click((function(){update_keycap_style(now_keycap_style=$(this).attr("value"))})),$("#mykeycap_system_change").click((function(){is_mac^=1,display_system_change(is_mac)})),$("#case-style-set").click((function(){$(".sidenav").sideNav("show")})),$("#mycase-style ul").on("click","li",(function(){update_case_style($(this).css("background-image"))})),$("#top-tabs .tab a").click((function(e,a){if(!isDeviceConnected)return;let s=$(this).attr("value");$("#user-tabs").children().each((function(){$(this).hasClass(s)?($(this).show(),$(this).hasClass("tabs")&&update_tab_indicator($(this))):$(this).hide()})),$("#user-content").children().each((function(){$(this).hasClass(s)?$(this).show():$(this).hide()})),$("#setting-panel").children().each((function(){$(this).hasClass(s)?($(this).show(),update_tab_indicator($(this).find(".tabs"))):$(this).hide()})),"top-tester"==s?(select_editingKey(0),matrix_test_on(1,"adc")):(matrix_test_on(0),$("#user-keyboard").find(".active, .valid").removeClass("active valid"),$("#user-keymaps-tabs").tabs("select","#layer-0"))})),$("#user-keymaps-tabs .tab a").click((function(e,a){let s=parseInt($(this).attr("id").match(/layer-(\d+)/)[1]),t=s<editingLayer?"up":"down";editingLayer=s,$('[id^="layer-"]').each((function(){let e=parseInt($(this).attr("id").match(/layer-(\d+)/)[1]);e!=s?$(this).text(e):$("#layer-"+s).html(`<span class="transparent"><i class="material-icons">layers</i>Layer ${s}</span>`)})),$("#user-keymaps-tabs .indicator").html(`<i class="material-icons">layers</i>Layer ${s}`),select_editingKey(0),$("#user-keyboard").find(".keyboard-mask").addClass("hidef"),$("#user-keyboard").find(".key").each((function(){$(this).removeClass("fade-in-down fade-in-up").addClass(`fade-out-${t}`).removeAttr("length stabilizer")})),setTimeout((function(){$("#user-keyboard").find(".key").each((function(){$(this).removeClass("fade-out-down fade-out-up").addClass(`fade-in-${t}`)})),setTimeout((function(){$("#user-keyboard").find(".key").removeClass("fade-in-down fade-in-up")}),400),load_keymap_on_keyboard(nowKBD.keymaps[s])}),350),$("#keymap-layer-clear").hasClass("recovery")&&$("#keymap-layer-clear").removeClass("recovery").text("清空当前层设置")}));var load_keymap_on_keyboard=function(e){for(var a in null==e&&(e=nowKBD.keymaps[editingLayer]),$("#this_layout_keys").text("0"),$("#layout-info-pane").hasClass("showf")&&$("#layout-info-pane").removeClass("showf").addClass("hidef"),e)for(var s in e[a]){var t=e[a][s],n="k"+parseInt(a).toString(32)+parseInt(s).toString(32),o=display_label(t,n);$(".key."+n).each((function(){$(this).attr("kcode",hex16(t,"0x")),$(this).html(o.name).attr("data-tooltip",o.desc),update_keymap_tooltip($(this)[0],t)}))}};let lastHoverSoundKey=0;var mod_pressed_editingKey;$("#user-keyboard").on("mouseover mouseout",".key",(function(e){let a=$(this).closest(".key");if(null==a.attr("data-tooltip"))return;let s=a.attr("kcode"),t=$(":hover");"mouseover"==e.type?lastHoverSoundKey!=s&&(lastHoverSoundKey=s,play_sound("sound/key_hover.wav")):"mouseout"==e.type&&(t[t.length-1].classList.contains("key")||(lastHoverSoundKey=0))})),$("#user-keymaps-tabs").on("mouseover mouseout",".tab a",(function(e){var a=parseInt($(this).attr("id").match(/layer-(\d+)/)[1]);a!=editingLayer&&"gmk"==now_keycap_style&&(bottom_content_layer=a,"mouseover"==e.type?(e.shiftKey&&($("#user-keymaps-tabs").find(".bottom").removeClass("bottom"),$(this).addClass("bottom")),$("#user-keyboard").find(".key:visible").each((function(){let e=this.className.match(/k([0-9a-v])([0-9a-v])/i);if(e){let t=display_label(nowKBD.keymaps[a][parseInt(e[1],32)][parseInt(e[2],32)],e[0]);if(t.name=t.name.replace(/fs(\d+)/g,"fs10").replace(/midfont/g,"bottomfont").replace(/bigfont/g,"bottomfont").replace(/<br>/g," ").replace("font-size","nofont").replace('<div style="height:15px"></div>',""),$(this).find(".bottom_content").remove(),0==$(this).closest(".encoder").length){var s=this.title;$(this).append(`<span class="bottom_content">${t.name}`),$(this).attr("title",s)}}}))):"mouseout"==e.type&&(e.shiftKey?(console.log("keep layer "+a),$("#user-keymaps-tabs").find(".tab a").each((function(){console.log(this.id),this.id=="layer-"+a?$(this).addClass("bottom"):$(this).removeClass("bottom")}))):(bottom_content_layer=255,$("#user-keyboard").find(".bottom_content").remove(),$("#user-keymaps-tabs").find(".bottom").removeClass("bottom"))))})),$("#layouts-set").on("mouseover mouseout","label span",(function(e){var a=$(this).attr("for");console.log(a);var s=$("#user-keyboard").find(`#kb${a}, [layout=${a.slice(-2)}]`);s&&("mouseover"!=e.type||$("#layouts-set").find("#"+a).prop("checked")?"mouseout"==e.type&&($("#user-keyboard").find(".keyboard-mask").addClass("hidef"),s.find("[class^=mykeycap]").each((function(e){$(this).css("z-index","")})),s.css("z-index",""),$("#layouts-set").find("#"+a).prop("checked")||s.hide()):($("#user-keyboard").find(".keyboard-mask").removeClass("hidef"),s.show(),s.find("[class^=mykeycap]").each((function(e){$(this).css("z-index","12")})),s.css("z-index","12")))})),$("#keycode_tabs").on("click",".key-set:not(.disable)",(function(e,a){var s=parseInt($(this).attr("kc"));if(mods&&s<255&&(s|=(15&mods)<<8),s<=255&&s>=224&&s<=229&&(mods&=~(1<<s-224)),kxxEditing){ani_fly_button(s,{top:e.pageY,left:e.pageX}),editingKeySetCode(s)}else{var t=lang_from_json("select_key_first");M.toast({html:t,classes:"rounded",displayLength:"1000"})}})),document.addEventListener("keydown",(function(e){var a=e.keyCode,s=keyCode2tmkCode(256*e.location+a);s<256&&0==keyState[s]&&(keyState[s]=1);if(console.log(`KeyDN:js keycode: 0x${(256*e.location+a).toString(16)}. Key:${[tmkCode2keyName(s)]}`),$("#tabs-keys-basic").find(`[kc=${s}]`).each((function(e){$(this).addClass("keydown")})),s>=224&&s<=229?(mods|=1<<s-224,mod_pressed_editingKey=$(".key-editing")[0]):mod_pressed_editingKey=null,$(":hover").length>4&&"user-keyboard"==$(":hover")[4].id||$(":hover").length>5&&"tabs-keys-basic"==$(":hover")[5].id){if(e.returnValue=!1,!kxxEditing)return;if((s<224||s>=228)&&!mods)ani_fly_button(s,getElementAbsPos($("#tabs-keys-basic").find(".keydown")[0])),editingKeySetCode(s)}}));var last_keyup_modskey=0;function kxxToPos(e){var a=e.match(/k([0-9a-v])([0-9a-v])/i);if(!a)throw"invalid id";return{row:parseInt(a[1],32),col:parseInt(a[2],32)}}function editingKeySetCode(e){let a=0,s=$("#user-keyboard").find(".key-editing");if(s.hasClass("halfkey")&&(a=s.parent().closest(".key").attr("kcode")),s.length>0&&kxxEditing){mods&&e>=2&&e<=255&&(e|=mods<<8),a&&(e=65280&a|255&e);let c=kxxToPos(kxxEditing);console.info(`Set keymaps[${editingLayer}][${c.row}][${c.col}] = ${hex16(e,"0x")}`),nowKBD.keymaps[editingLayer][c.row][c.col]=e,webhid_set_single_key(editingLayer,c.row,c.col,e);var t=display_label(e,kxxEditing),n=t.name,o=t.desc;if(bottom_content_layer<8&&bottom_content_layer!=editingLayer){var i=display_label(nowKBD.keymaps[bottom_content_layer][c.row][c.col],kxx);i.name=i.name.replace(/fs(\d+)/g,"fs10").replace(/midfont/g,"bottomfont").replace(/bigfont/g,"bottomfont").replace(/<br>/g," ").replace("font-size","nofont").replace('<div style="height:15px"></div>',""),n+=`<span class="bottom_content">${i.name}`}$("."+kxxEditing).each((function(){var e=$(this);e.removeClass("fade-in-down fade-in-up").addClass("fade-out-down"),setTimeout((function(){e.removeClass("fade-out-down fade-out-up").addClass("fade-in-down").html(n),setTimeout((function(){e.removeClass("fade-in-down fade-in-up")}),350)}),300)})),$("."+kxxEditing).attr("data-tooltip",o);var d=s.find(".key");d&&(update_keymap_tooltip(d[0],e),d.attr("kcode",hex16(e,"0x"))),select_next_editing_key()}}function select_next_editing_key(){let e,a=$("#user-keyboard").find(".key-editing");for(;"user-keyboard"!=a.attr("id")&&(a.nextAll().each((function(){if(e=$(this).is("[class^=mykeycap]:visible")?$(this):$(this).find("[class^=mykeycap]:visible").first(),e.length>0)return!1})),!(e&&e.length>0));)a=a.parent();0==e.length&&(e=0),setTimeout((function(){select_editingKey(e)}),300)}function update_keymap_tooltip(e,a){let s=M.Tooltip.getInstance(e);var t=e.parentElement.parentElement.parentElement,n=t.classList.contains("round"),o=t.classList.contains("square"),i=t.dataset.usertip;if(n||o||i||100==a||a>=165&&224!=(240&a)||a>255||0==a){if(n){let a="";a=lang_from_json(`encoder_round${e.parentElement.parentElement.parentElement.className.match(/(.sw|.ccw|.cw)/g)[0]}`),e.dataset.tooltip=a+e.dataset.tooltip}if(o){let a="";a=lang_from_json(`encoder_square${e.parentElement.parentElement.parentElement.className.match(/(.sw|.upward|.dnward)/g)[0]}`),e.dataset.tooltip=a+e.dataset.tooltip}i&&(e.dataset.tooltip=i+e.dataset.tooltip),null==s&&(s=M.Tooltip.init(e),s.options.margin=-8)}else s&&s.destroy(),e.removeAttribute("data-tooltip")}document.addEventListener("keyup",(function(e){var a=e.keyCode,s=keyCode2tmkCode(256*e.location+a);s<256&&(keyState[s]=0);var t,n=mods;if(console.log(`KeyUP:js keycode: 0x${(256*e.location+a).toString(16)}. Key:${tmkCode2keyName(s)}`),$("#tabs-keys-basic").find(`[kc=${s}]`).each((function(e){t=$(this),$(this).removeClass("keydown")})),s>=224&&s<=229&&(mods&=~(1<<s-224)),$(":hover").length>4&&"user-keyboard"==$(":hover")[4].id||$(":hover").length>5&&"tabs-keys-basic"==$(":hover")[5].id){if(e.returnValue=!1,!kxxEditing)return;0==last_keyup_modskey&&mod_pressed_editingKey==$(".key-editing")[0]&&0==mods&&(70==s||s>=224)&&(ani_fly_button(s,getElementAbsPos(t[0])),editingKeySetCode(s));for(var o=0,i=0;i<8;i++)mods&1<<i&&o++;if(console.log(`mods_num:${o}, code: ${s}`),o>0&&(last_keyup_modskey=o),n&&s<224){var d=mods<<8|s;ani_fly_button(d,getElementAbsPos(t[0])),editingKeySetCode(d),last_keyup_modskey=d}else 0==o&&(last_keyup_modskey=0)}})),$("#advanced-mode-toggle").click((function(){$("#advanced-mode-layer").css("display",$(this).prop("checked")?"block":"none")})),$("#keymap-layer-copy").click((function(){for(var e=0;e<8;e++)for(var a=0;a<16;a++)keymaps_layer[e][a]=keymaps[editingLayer][e][a];$("#copied-layer_1, #copied-layer_2").text(editingLayer)})),$("#keymap-layer-paste").click((function(){keymaps[editingLayer]=Array.from(keymaps_layer),load_keymap_on_keyboard()})),$("#keymap-layer-clear").click((function(){$(this).hasClass("recovery")?($(this).removeClass("recovery").text("清空当前层设置"),keymaps[editingLayer]=Array.from(keymaps_layer)):($(this).addClass("recovery").text("恢复当前层设置"),keymaps_layer=Array.from(keymaps[editingLayer]),keymaps[editingLayer]=Array.from(transparent_map())),load_keymap_on_keyboard()})),$("#preset-keymap-list, #user-keyboard").on("click","li",(function(){var e=$("#user-keyboard").find("#kb-preset_keymap").find("[id^='kb-preset_keymap-"+this.value+"']"),a=e.attr("value-keymap"),s=url_decode_keymap(a.replace(/YDKB/g,"+"));null!=s&&(firmware_keymaps=s,console.log(firmware_keymaps));var t=e.attr("value-layout");t&&(imported_layout=unzip(t),import_layout(imported_layout)),load_keymap(),load_keymap_on_keyboard()}));var load_keymap=function(){for(keymaps=$.extend(!0,[],firmware_keymaps);keymaps.length<KEYMAP_LAYERS;)keymaps.push(transparent_map());var e=""+parseInt(keymaps[1][0][0]<<16|keymaps[0][0][0]);if(console.log(parseInt(user_layouts_i)+1+" layouts:"+e),"1"==e.slice(0,1)&&e.length-2==user_layouts_i){var a=e.slice(1).match(/(\d)/g);0==layouts_save&&(layouts_save=e.slice(1));for(var s=0;s<user_layouts_i+1;s++){for(var t=0;t<$(`div[id^='kblayouts-${s}`).length+1;t++)$(`#kblayouts-${s}${t}`).hide(),$(`#layouts-${s}${t}`).prop({checked:"false"}),$("#user-keyboard").find(`.layout-${s}${t}`).hide(),$("#user-keyboard").find(`[layout=${s}${t}]`).hide();$(`#kblayouts-${s}${a[s]}`).show(),$(`#layouts-${s}${a[s]}`).prop({checked:"checked"}),$("#user-keyboard").find(`.layout-${s}${a[s]}`).show(),$("#user-keyboard").find(`[layout=${s}${a[s]}]`).show()}}update_indicator(10),update_indicator_color(10)},layout_load=function(e){var a=CONFIG.kbd[nowKBD.sid].case;if(a){var s,t,n,o,i;a.M?s=t=n=o=a.M:(s=a.MU?a.MU:-12,t=a.MR?a.MR:-12,n=a.MD?a.MD:-12,o=a.ML?a.ML:-12),i=a.BR?a.BR:-o-6;var d=56*a.X-o-t,c=56*a.Y-s-n}var l=c+24;a.EY&&(l+=56*a.EY),a.MaskHeight&&(l=a.MaskHeight);var r=$(".keyboard-mask")[0];fetch(e).then(checkResponse).then(parseTEXT).then((function(e){if($("#user-keyboard").html(e),a&&($("#user-keyboard").prepend(r),a.X&&a.Y)){var _=`min-height: ${l-30}px; width: 56px; padding: ${-s-8}px 0 0 ${640-27*a.X}px;`;$("#mykbd").attr("style",_);var m=` style="margin: ${s}px ${t}px ${n}px ${o}px; height: ${c}px; width: ${d}px; border-radius: ${i}px">`;let e='<div class="kbdbg-mask" '+m,r='<div class="kbdbg-border" '+m;$("#mycase").prepend(e).prepend(r)}generate_kbd_layout();var p,u=$("#kbd-info").attr("value-type");if(u){var y=$("#kbd-firmware").attr("value-filename");if(null==y){y=CONFIG.kbd[select_kbd].name;var f=$("#kbd-firmware").attr("value-filename");f&&(y=f),"lufa_msd_usb"==u&&(u="lufa_msd_ble"),"lufa_msd_ble"==u&&(y=y.toUpperCase())}var k=$("#kbd-firmware").attr("value-diskname");null==k&&(k=y),moduleLoad_bootloader(y,k,u)}else p=$("#kbd-info").html(),$("#kbd-info").remove(),$("#kbdinfo_detail").empty(),p||$("#kbdinfo_detail").append("暂无其他说明");$("#purchase-link").empty(),$("#purchase-link").append(`<li class="waves-effect waves-light"><a href="#!">尊重劳动成果，远离山寨。右侧为 ${CONFIG.kbd[nowKBD.sid].name} 正规购买渠道和介绍。`);var C=$("[id^='kbd-purchase_link_']");$(".fixed-action-btn.toolbar").find(".scale-transition").toggleClass("scale-out",0==C.length),C.each((function(e){$("#purchase-link").append(`<li class="waves-effect waves-light"><a href=${$(this).attr("value")} target="_blank">${$(this).text()}`),$(this).remove()})),$("#kbd-macrofn").remove(),moduleLoad_led_fn("/config/templates_led_fn.html"),$("#preset-keymap-group").hide(),$("#preset-keymap-list").empty(),$("#kb-preset_keymap").length>0&&($("#preset-keymap-group").show(),$("[id^='kb-preset_keymap-']").each((function(){var e=this.id.replace("kb-preset_keymap-","");$("#preset-keymap-list").append(li_vtl(e,this.title,'<i class="material-icons mr5">cloud_download</i>'+$(this).text()))}))),onLangChange(NOW_LANG)})).catch((function(e){console.log("request failed",e)}))};function select_editingKey(e){if(0==e){let e=$("#user-keyboard").find(".key-editing").removeClass("key-editing");if(e.length){let a=M.Tooltip.getInstance(e[0]);a&&a.destroy()}$("main").removeClass("editing-key"),kxxEditing=null,$("#fly-button").removeClass("fly")}else{if(select_editingKey(0),e.hasClass("halfkey")){let a=e.parent().closest(".key")[0].classList[1];e.addClass(a),kxxEditing=a}else kxxEditing=e.find(".key")[0].classList[1];if("k80"==kxxEditing)return;e.addClass("key-editing"),$("main").addClass("editing-key"),e.addClass("tooltipped"),e.attr("data-tooltip","Press or pick a key to bind");let a=M.Tooltip.init(e[0],{position:"top",margin:-20});$(a.tooltipEl).find(".aug")[0].style.setProperty("--aug-border-bg","var(--color-mykeycap2)"),a.open()}}function moduleLoad_led_fn(e){}function moduleLoad_bootloader(e,a,s){}function update_kbdinfo_detail(e){$("#kbdinfo_detail").html(e),init_space($("#kbdinfo_detail")),console.log($("#kbd-info").attr("value-type")),"lufa_msd_usb"==$("#kbd-info").attr("value-type")&&$("#kbdinfo_detail").find(".for-ble").remove(),CONFIG.kbd[select_kbd].checksum?$("#kbdinfo_detail").find(".hardware2bl").remove():$("#kbdinfo_detail").find(".software2bl").remove(),$("#kbdinfo_detail").html($("#kbdinfo_detail").html().replaceAll("<hanla></hanla>"," "))}function li_vtl(e,a,s){return`<li value="${e}" title="${a}" lang="zh_sc"> <a lang="zh_sc">${s}`}function update_ui_color(e){$.cookie&&(null==e?e=$.cookie("uicolor"):$.cookie("uicolor",e,{expires:365,path:"/"})),e&&(document.documentElement.style.setProperty("--uicolor",e),$("html").toggleClass("dark-mode","rgb(36, 36, 36)"==e.toString()))}function update_case_style(e){$.cookie?null==e?e=$.cookie("ck_case_style"):$.cookie("ck_case_style",e,{expires:365,path:"/"}):null==e&&now_case_style&&(e=now_case_style),e&&(document.documentElement.style.setProperty("--mycase-background-image",e),now_case_style=e)}function update_keycap_style(e){$.cookie?null==e?(e=$.cookie("ck_keycap_style"),now_keycap_style=e||"gmk"):$.cookie("ck_keycap_style",e,{expires:365,path:"/"}):null==e&&now_case_style&&(e=now_keycap_style),e&&null!=e&&($("#user-keyboard").removeClass("gmk dsa flat").addClass(e),load_keymap_on_keyboard())}function display_system_change(e){$("#user-keyboard").find(".key:visible").toggleClass("fade-in-down",e).toggleClass("fade-in-up",!e),setTimeout((function(){$("#user-keyboard").find(".key").removeClass("fade-in-down fade-in-up")}),400),load_keymap_on_keyboard();$("#mykeycap_system_change button").removeClass("using"),e?$("#system_mac").addClass("using"):$("#system_win").addClass("using"),$(".key-set").each((function(e){var a=display_label(parseInt($(this).attr("kc")),0);let s=$(this).closest("#tabs-keys-media-mouse").length>0,t=$(this).closest("#tabs-keys-mods").length>0;s||t?($(this).addClass("tooltipped"),$(this).attr("data-tooltip",a.desc)):$(this).attr("title",removeHTMLTags(a.desc)),$(this).html(a.name)}))}function generate_kbd_layout(){var e,a;if($("#user-keyboard").find("kp").each((function(){var e=this.outerHTML;e=e.replaceAll(", ","</kp><kp>").replaceAll(",","</kp><kp>"),$(this).replaceWith(e)})),$("#user-keyboard").find("kp").each((function(){var e=$(this).text().match(/.*? \[(.*)\]/),a="";e&&(a=e[1]),-1==a.indexOf("mc")&&(a="mc1 "+a),$(this).prependClass(a);var s=this.outerHTML;e&&(s=s.replace(` [${e[1]}]`,"")),s=s.replace(/^<kp/,"<div").replace(/\/kp>$/,"/div>"),$(this).replaceWith(s)})),$("#user-keyboard .mycase").find("div").each((function(){var e=this.className.match(/.*?col(\d+).*?/);e&&$(this).css("left",e[1]/100*56+"px");var a=this.className.match(/.*?row(\d+).*?/);a&&$(this).css("top",a[1]/100*56+"px")})),$("#user-keyboard").find("[X], [Y], .mc1, .mc2, .mc3, .mykeycap1, .mykeycap2, .mykeycap3").each((function(){if($(this).parents("svg").length)return 1;if(!$(this).hasClass("round")&&!$(this).hasClass("square")){var s=$(this).attr("X"),t=$(this).attr("Y"),n=$(this).attr("W"),o=$(this).attr("H");if(!s){var i=this.className.match(/.*?col(\d+).*?/);i&&(s=i[1]/100,$(this).removeClass(`col${i[1]}`))}if(!t){var d=this.className.match(/.*?row(\d+).*?/);d&&(t=d[1]/100,$(this).removeClass(`row${d[1]}`))}if(!n){n=1;var c=this.className.match(/.*? w(\d+).*?/);c&&(1.5==(n=c[1]/100)&&$(this).hasClass("h200")||$(this).removeClass(`w${c[1]}`))}if(!o){o=1;var l=this.className.match(/.*? h(\d+).*?/);l&&(o=l[1]/100)}s||-1==this.className.indexOf("mc")||(s=0==$(this).prev().length?0:parseFloat(e)+parseFloat(a)),null!=s&&($(this).css("left",56*s+"px"),e=s),null!=t&&$(this).css("top",56*t+"px"),null!=n&&($(this).css("width",56*n+"px").css("--width",56*n+"px"),a=n),null!=o&&$(this).css("--height",56*o+"px"),-1==this.className.indexOf("mykeycaps")&&$(this).css("position","relative")}})),$("#user-keyboard").find(".mykeycap1, .mykeycap2, .mykeycap3, .mc1, .mc2, .mc3").each((function(){this.className=this.className.replace("mc","mykeycap");var e=$(this).find(".key");if(e.length>0&&e.attr("class").match(/k([0-9a-v][0-9a-v])/i).length>0)return!0;let a=$(this).text().toLowerCase();var s="";$(this).css("--width")&&(s+="width: calc(var(--width) + 6px);"),$(this).css("--height")&&(s+="height: calc(var(--height) + 6px);"),$(this).html(`<div class="plate" style="${s}"></div><div class="border"><div class="top"><div class="key ${a}">`);var t=$(this).attr("class").match(/.*(led(\d)).*/);if(t&&($(this).removeClass(t[1]).find(".border").prepend(`<div class="kbd-led ${t[1]}">`),$(this).hasClass("suden")&&$(this).removeClass("suden").find(".kbd-led").addClass("suden"),t[2]>7)){var n=$(this).attr("data-tooltip"),o=$(this).attr("led-color");o||(o="red"),$(this).removeAttr("data-tooltip led-color").find(".kbd-led").attr("data-tooltip",n).css("background-color",o)}})),$("#user-keyboard").find(".kbd-led").each((function(){$(this).attr("class").match(/.*(led(\d)).*/)&&$(this).addClass("tooltipped").attr("data-position","left")})),$("#layouts-set").empty(),$("#layouts-set-div, #layouts-set-on2").hide(),$("#kblayouts-00").length>0){if($("#layouts-set-div, #layouts-set-on2").show(),$("#layouts-set-on").removeClass("scale-out"),$("#layouts-set").empty(),layouts_save)var s=layouts_save.match(/(\d)/g);user_layouts_i=0,$("div[id^='kblayouts-']").each((function(){var e=this.id.match(/kblayouts-(\d)(\d)/),a=e[1],t=e[2];user_layouts_i<a&&(user_layouts_i=a),console.log("user_layouts_i:"+a),0==t&&($("#layouts-set").append('<div class="rowstart">[ '+$(this).attr("value-desc")+" ]"),$("#layouts-set").append('<div id="layouts-'+a+'">'),s&&s[a]||(layouts_save+="0")),$("#layouts-"+a).append('<label><input type="radio" id="layouts-'+a+t+'" class="layouts-'+a+' with-gap" name="layouts-'+a+'"/><span for="layouts-'+a+t+'">'+$(this).attr("value-name")),$(`#kblayouts-${a}${t}, [layout=${a}${t}], .layout-${a}${t}`).css("display",0==t?"block":"none"),s&&s[a]&&($("#kblayouts-"+a+"0").hide(),$("#kblayouts-"+a+s[a]).show()),"block"==$(this).css("display")&&$("#layouts-"+a+t).prop({checked:"checked"})}))}}function update_indicator(e,a){if(e<8){indicator[e]=a,keymaps[2][0][0]=indicator[0]|indicator[1]<<8,keymaps[3][0][0]=indicator[2]|indicator[3]<<8,keymaps[4][0][0]=indicator[4]|indicator[5]<<8,keymaps[5][0][0]=indicator[6]|indicator[7]<<8;var s=$(`#indicator_dropdown_menu li[value=${indicator[e]}]`);s&&$("#indicator_dropdown-btn_"+e).text(s.text()).attr({"data-tooltip":s.attr("data-tooltip"),value:indicator[e]});var t=$("#indicator_dropdown-name_"+e).text()+" : "+$("#indicator_dropdown-btn_"+e).text();$("#user-keyboard").find(".kbd-led.led"+e).attr("data-tooltip",t)}else{for(var n=new Array,o=0;o<4;o++){var i=keymaps[o+2][0][0];n[2*o]=255&i,n[2*o+1]=i>>8}for(o=0;o<8;o++)update_indicator(o,n[o])}7==e&&console.log(keymaps[2][0][0].toString(16),keymaps[3][0][0].toString(16),keymaps[4][0][0].toString(16),keymaps[5][0][0].toString(16))}function update_indicator_color(e,a){}function update_keycap_color(e){$.cookie?null==e&&$.cookie("ck_keycap_color")?e=$.cookie("ck_keycap_color").match(/#(.{6})/g):e&&6==e.length&&$.cookie("ck_keycap_color",e,{expires:365,path:"/"}):null==e&&now_keycap_color&&(e=now_keycap_color),null==e&&(e=["#222d5a","#e1dbd1","#d8a0a6","#222d5a","#222d5a","#d8a0a6"]),6==e.length&&(document.documentElement.style.setProperty("--color-mykeycap1",e[0]),document.documentElement.style.setProperty("--bgcolor-mykeycap1",e[1]),document.documentElement.style.setProperty("--color-mykeycap2",e[2]),document.documentElement.style.setProperty("--bgcolor-mykeycap2",e[3]),document.documentElement.style.setProperty("--color-mykeycap3",e[4]),document.documentElement.style.setProperty("--bgcolor-mykeycap3",e[5]),now_keycap_color=e,$("#keycap_color-user").find('[onchange^="update_keycap_color_single("]').each((function(){var a=$(this).attr("onchange").slice(27,28),s=e[a].slice(1,7);$(this)[0].jscolor.fromString(s),$(this).attr("value",s)})),$(".border .top").css("background-color","transparent"),$(".border .top").css("background-color",""))}function update_keycap_color_single(e,a){console.log("set color "+e+" to "+a),console.log(now_keycap_color),now_keycap_color[e]="#"+a,update_keycap_color(now_keycap_color),$("#user-keycap-colors").val(now_keycap_color)}function update_case_color(e){e&&6==e.length&&(e="#"+e),$.cookie?null==e?e=$.cookie("ck_case_color"):$.cookie("ck_case_color",e,{expires:365,path:"/"}):now_case_color&&(e=now_case_color),e&&($("#case_color_css").remove(),$(`<style id="case_color_css" type="text/css">.mycase{background-color: ${e}!important}</style>`).appendTo("head"),now_case_color=e)}function update_plate_color_user(e){6==e.length&&(e="#"+e,$("#plate_color_css").remove(),$(`<style id="plate_color_css" type="text/css">.plate{background-color: ${e}!important}</style>`).appendTo("head"),now_case_color=e)}function jsdef_init(){$(".jsdef").each((function(){var e=$(this).attr("class"),a=e.match(/(.*?)ml-(\d+)(.*?)/),s=e.match(/(.*?)pl-(\d+)(.*?)/),t=e.match(/(.*?)ht-(\d+)(.*?)/),n=e.match(/(.*?)wd-(\d+)(.*?)/),o=e.match(/(.*?)lh-(\d+)(.*?)/);a&&$(this).css({"margin-left":a[2]+"px"}),s&&$(this).css({"padding-left":s[2]+"px"}),t&&$(this).css({height:t[2]+"px"}),n&&$(this).css({width:n[2]+"px"}),o&&$(this).css({"line-height":o[2]+"px"})}))}function tooltip_init(){$(".tooltipped").tooltip({delay:50}),update_indicator_color(10)}function user_keycap_colors(e){console.log(e)}function process_html_page(){add_some_css_to_head(),update_copyright(),$(".waves-effect").addClass("waves-light");for(let e=1;e<5;e++)e<4?$("#keycap_color-user-setting").append(`<div><a class="col mykeycap${e} key-flat" title="Keycaps1" lang="zh_sc">Main</a></div>                     <div><a lang="zh_sc">文字颜色</a><input class="col btn jscolor" type="show"  onchange="update_keycap_color_single(${2*(e-1)},''+this.jscolor)" value="ffffff"></div>                     <div><a lang="zh_sc">键帽颜色</a><input class="col btn jscolor" type="show"  onchange="update_keycap_color_single(${2*(e-1)+1},''+this.jscolor)" value="ffffff"></div>`):$("#keycap_color-user-setting").append('<div><a class="col mycase key-flat" style="padding: 6px" title="Keycaps3" lang="zh_sc"><span class="plate" style="width: calc(100% - 6px);height: calc(100% - 6px);"></span></a></div>                     <div><a lang="zh_sc" class="tooltipped" data-tooltip="建设中，切换键帽样式可以恢复到默认颜色">外壳颜色(dev)</a> <input class="col btn jscolor" type="show"  onchange="update_case_color(\'\'+this.jscolor)" value="ffffff"> </div>                     <div><a lang="zh_sc" class="tooltipped" data-tooltip="建设中，刷新页面可以恢复到默认颜色">定位板(dev)</a> <input class="col btn jscolor" type="show"  onchange="update_plate_color_user(\'\'+this.jscolor)" value="ffffff"> </div>');jscolor.installByClassName("jscolor"),setting_panel_init(),lang_init()}function setting_panel_init(){let e;$("#setting-panel .keyboard-set").find("ks").each((function(){let e=this.outerHTML;e=e.replaceAll(", ","</ks><ks>").replaceAll(",","</ks><ks>"),$(this).replaceWith(e)})),$("#setting-panel .keyboard-set").find("ks").each((function(){let a=this.outerHTML,s=$(this).text().match(/.*? \[(.*)\]/),t="";s?(t=s[1],e=t,a=a.replace(`[${t}]`,"")):t=e,a=a.replace(/^<ks>/,`<li class="${t}" ks=`).replace(/<\/ks>$/,"></li>"),$(this).replaceWith(a)})),$("#setting-panel .keyboard-set").find("li").each((function(e){if($(this).attr("ks")){let e;if($(this).attr("ks")){e=$(this).attr("ks");let a=name_to_code(e);null!=a&&$(this).attr("kc",a)}$(this).html(get_keyinfo(e).name),null==$(this).attr("class")&&-1==$(this).html().indexOf("<br>")&&$(this).addClass("t1"),$(this).addClass("key-set")}})),$("#tabs-keys-mods").find("span").each((function(e){if($(this).attr("kc")){let e=parseNumber($(this).attr("kc"));$(this).text(removeHTMLTags(get_keyinfo(e).name).replace("_",""))}})),$("#setting-panel").find(".keys-category").attr("lang","zh_sc")}$("#user-keyboard").on("mousedown",(function(e){$(":hover").length<=6&&select_editingKey(0)})),$("#user-keyboard").on("mousedown","[class^='mykeycap']",(function(e){if(!$("#user-keymaps-tabs").is(":hidden")){if($(this).hasClass("key-editing"))select_editingKey(0);else{let e=$(":hover");if(e[e.length-1].classList.contains("halfkey")){let e=$(this).find(".halfkey");e.hasClass("key-editing")?(e.removeClass("key-editing"),select_editingKey(0)):(e.addClass("key-editing"),select_editingKey(e))}else select_editingKey($(this))}1==e.button&&(e.preventDefault(),e.shiftKey?editingKeySetCode(0):editingKeySetCode(1))}})),$("#import-user-keycap-colors").click((function(e,a){console.log($("#user-keycap-colors").val());var s=$("#user-keycap-colors").val().split(",");s instanceof Array&&6==s.length&&update_keycap_color(s)})),$("#tabs-keys-mods-card input").on("change",(function(){let e,a,s,t;$("#tabs-keys-mods-card").find("input").each((function(){let t=$(this).attr("name");"lrmods"!=t&&"mods"!=t||!$(this).prop("checked")||(e|=$(this).val()),"action"==t&&15&e&&$(this).prop("checked")&&(a=$(this).val(),"layermods"==a?$("#tabs-keys-mods-card").find(".layermods").show():$("#tabs-keys-mods-card").find(".layermods").hide()),"layer"==t&&$(this).prop("checked")&&(s=$(this).val())})),"layermods"==a?t=keyToCode._QK_LAYER_MOD|(15&s)<<4|15&e:(t|="modstap"==a?keyToCode._QK_MOD_TAP:0,t|=e<<8),$("#tabs-keys-mods-card").find(".key-set.result").attr("kc",t).html(get_keyinfo(t).name).attr("data-tooltip",get_keyinfo(t).desc)}));